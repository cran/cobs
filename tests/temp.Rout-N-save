
R : Copyright 2002, The R Development Core Team
Version 1.5.0 Under development (unstable) (2002-04-17)

R is free software and comes with ABSOLUTELY NO WARRANTY.
You are welcome to redistribute it under certain conditions.
Type `license()' or `licence()' for distribution details.

R is a collaborative project with many contributors.
Type `contributors()' for more information.

Type `demo()' for some demos, `help()' for on-line help, or
`help.start()' for a HTML browser interface to help.
Type `q()' to quit R.

> T <- F <- NULL
> #### Example 1 of   He and Ng (1999) :
> #### -------------------------------
> if(!interactive()) postscript("temp.ps", horizontal = TRUE)
> 
> library(cobs)
> 
> data(globtemp)
> str(globtemp)## time series T=113,  1880:1992
 Time-Series [1:113] from 1880 to 1992: -0.32 -0.32 -0.4 -0.39 -0.65 -0.43 -0.4 -0.52 -0.3 -0.12 ...
> 
> ## require(ts)# later for plotting
> ## At the moment forget about all time-series stuff; use num.vectors:
> str(year <- as.vector(time(globtemp)))
 num [1:113] 1880 1881 1882 1883 1884 ...
> str(temp <- as.vector(globtemp))
 num [1:113] -0.32 -0.32 -0.4 -0.39 -0.65 -0.43 -0.4 -0.52 -0.3 -0.12 ...
> 
> ## Codes for Figure 1a
> a50 <- cobs(year, temp, knots.add = TRUE, degree = 1, constraint = "increase")

 Performing general knot selection ...
  N[rq,L1]= (113, 0); ([ei]qc= 0,1, vars=2)  _fixed_ (tau,lam)= (0.5, 1):
  N[rq,L1]= (113, 0); ([ei]qc= 0,2, vars=3)  _fixed_ (tau,lam)= (0.5, 1):
  N[rq,L1]= (113, 0); ([ei]qc= 0,3, vars=4)  _fixed_ (tau,lam)= (0.5, 1):
  N[rq,L1]= (113, 0); ([ei]qc= 0,4, vars=5)  _fixed_ (tau,lam)= (0.5, 1):
  N[rq,L1]= (113, 0); ([ei]qc= 0,5, vars=6)  _fixed_ (tau,lam)= (0.5, 1):

 WARNING! Since the number of  6  knots selected by  aic  reached the
   upper bound during general knot selection, you might want to rerun
   cobs with a larger number of knots. 

 Deleting unnecessary knots ...
  N[rq,L1]= (113, 0); ([ei]qc= 0,4, vars=5)  _fixed_ (tau,lam)= (0.5, 1):
  N[rq,L1]= (113, 0); ([ei]qc= 0,4, vars=5)  _fixed_ (tau,lam)= (0.5, 1):
  N[rq,L1]= (113, 0); ([ei]qc= 0,4, vars=5)  _fixed_ (tau,lam)= (0.5, 1):
  N[rq,L1]= (113, 0); ([ei]qc= 0,4, vars=5)  _fixed_ (tau,lam)= (0.5, 1):
  N[rq,L1]= (113, 0); ([ei]qc= 0,3, vars=4)  _fixed_ (tau,lam)= (0.5, 1):
  N[rq,L1]= (113, 0); ([ei]qc= 0,3, vars=4)  _fixed_ (tau,lam)= (0.5, 1):
  N[rq,L1]= (113, 0); ([ei]qc= 0,3, vars=4)  _fixed_ (tau,lam)= (0.5, 1):
  N[rq,L1]= (113, 0); ([ei]qc= 0,2, vars=3)  _fixed_ (tau,lam)= (0.5, 1):
  N[rq,L1]= (113, 0); ([ei]qc= 0,2, vars=3)  _fixed_ (tau,lam)= (0.5, 1):

 Searching for missing knots ...
  N[rq,L1]= (113, 0); ([ei]qc= 0,4, vars=5)  _fixed_ (tau,lam)= (0.5, 1):
  N[rq,L1]= (113, 0); ([ei]qc= 0,4, vars=5)  _fixed_ (tau,lam)= (0.5, 1):
  N[rq,L1]= (113, 0); ([ei]qc= 0,4, vars=5)  _fixed_ (tau,lam)= (0.5, 1):

 Computing the final fit ...
  N[rq,L1]= (113, 0); ([ei]qc= 0,3, vars=4)  _fixed_ (tau,lam)= (0.5, 1):
> summary(a50)
COBS regression spline (degree = 1) from call:
  cobs(x = year, y = temp, constraint = "increase", degree = 1,     knots.add = TRUE)
{tau=0.5}-quantile;  dimensionality of fit: 4 (4)
knots[1 .. 4]: 1880, 1947, 1969, 1992
coef  :
[1] -0.4426198  0.0200000  0.0200000  0.2960014
R^2 = 69.95% ;  empirical tau (over all): 58/113  = 0.5132743 (target tau : 0.5)
> ## As suggested in the warning message, we increase the number of knots to 9
> a50 <- cobs(year, temp, nknots = 9, knots.add = TRUE, degree = 1,
+             constraint = "increase")

 You are using 9 knots instead of the default number of 6 knots.

 Performing general knot selection ...
  N[rq,L1]= (113, 0); ([ei]qc= 0,1, vars=2)  _fixed_ (tau,lam)= (0.5, 1):
  N[rq,L1]= (113, 0); ([ei]qc= 0,2, vars=3)  _fixed_ (tau,lam)= (0.5, 1):
  N[rq,L1]= (113, 0); ([ei]qc= 0,3, vars=4)  _fixed_ (tau,lam)= (0.5, 1):
  N[rq,L1]= (113, 0); ([ei]qc= 0,4, vars=5)  _fixed_ (tau,lam)= (0.5, 1):
  N[rq,L1]= (113, 0); ([ei]qc= 0,5, vars=6)  _fixed_ (tau,lam)= (0.5, 1):
  N[rq,L1]= (113, 0); ([ei]qc= 0,6, vars=7)  _fixed_ (tau,lam)= (0.5, 1):
  N[rq,L1]= (113, 0); ([ei]qc= 0,7, vars=8)  _fixed_ (tau,lam)= (0.5, 1):
  N[rq,L1]= (113, 0); ([ei]qc= 0,8, vars=9)  _fixed_ (tau,lam)= (0.5, 1):

 Deleting unnecessary knots ...
  N[rq,L1]= (113, 0); ([ei]qc= 0,3, vars=4)  _fixed_ (tau,lam)= (0.5, 1):
  N[rq,L1]= (113, 0); ([ei]qc= 0,3, vars=4)  _fixed_ (tau,lam)= (0.5, 1):
  N[rq,L1]= (113, 0); ([ei]qc= 0,3, vars=4)  _fixed_ (tau,lam)= (0.5, 1):

 Searching for missing knots ...
  N[rq,L1]= (113, 0); ([ei]qc= 0,5, vars=6)  _fixed_ (tau,lam)= (0.5, 1):
  N[rq,L1]= (113, 0); ([ei]qc= 0,5, vars=6)  _fixed_ (tau,lam)= (0.5, 1):
  N[rq,L1]= (113, 0); ([ei]qc= 0,5, vars=6)  _fixed_ (tau,lam)= (0.5, 1):
  N[rq,L1]= (113, 0); ([ei]qc= 0,5, vars=6)  _fixed_ (tau,lam)= (0.5, 1):
  N[rq,L1]= (113, 0); ([ei]qc= 0,6, vars=7)  _fixed_ (tau,lam)= (0.5, 1):
  N[rq,L1]= (113, 0); ([ei]qc= 0,6, vars=7)  _fixed_ (tau,lam)= (0.5, 1):
  N[rq,L1]= (113, 0); ([ei]qc= 0,6, vars=7)  _fixed_ (tau,lam)= (0.5, 1):
  N[rq,L1]= (113, 0); ([ei]qc= 0,6, vars=7)  _fixed_ (tau,lam)= (0.5, 1):
  N[rq,L1]= (113, 0); ([ei]qc= 0,6, vars=7)  _fixed_ (tau,lam)= (0.5, 1):

 Computing the final fit ...
  N[rq,L1]= (113, 0); ([ei]qc= 0,5, vars=6)  _fixed_ (tau,lam)= (0.5, 1):
> summary(a50)
COBS regression spline (degree = 1) from call:
  cobs(x = year, y = temp, constraint = "increase", nknots = 9,     degree = 1, knots.add = TRUE)
{tau=0.5}-quantile;  dimensionality of fit: 6 (6)
knots[1 .. 6]: 1880, 1908, 1936, ... , 1992
coef  :
[1] -0.40678101 -0.31185185  0.02000000  0.02000000  0.06666667  0.43641324
R^2 = 70.87% ;  empirical tau (over all): 60/113  = 0.5309735 (target tau : 0.5)
> ## Here, we use the same knots sequence chosen for the 50th percentile
> a10 <- cobs(year, temp, nknots = length(a50$knots), knots = a50$knot,
+             degree = 1, tau = 0.1, constraint = "increase")
  N[rq,L1]= (113, 0); ([ei]qc= 0,5, vars=6)  _fixed_ (tau,lam)= (0.1, 1):
> summary(a10)
COBS regression spline (degree = 1) from call:
  cobs(x = year, y = temp, constraint = "increase", knots = a50$knot,     nknots = length(a50$knots), degree = 1, tau = 0.1)
{tau=0.1}-quantile;  dimensionality of fit: 6 (6)
knots[1 .. 6]: 1880.000, 1908.000, 1936.000, ... , 1992.000
coef  :
[1] -0.5515010 -0.4255000 -0.1400000 -0.1400000 -0.0800000  0.1300034
empirical tau (over all): 13/113  = 0.1150442 (target tau : 0.1)
> a90 <- cobs(year, temp, nknots = length(a50$knots), knots = a50$knot,
+             degree = 1, tau = 0.9, constraint = "increase")
  N[rq,L1]= (113, 0); ([ei]qc= 0,5, vars=6)  _fixed_ (tau,lam)= (0.9, 1):
> summary(a90)
COBS regression spline (degree = 1) from call:
  cobs(x = year, y = temp, constraint = "increase", knots = a50$knot,     nknots = length(a50$knots), degree = 1, tau = 0.9)
{tau=0.9}-quantile;  dimensionality of fit: 6 (6)
knots[1 .. 6]: 1880.000, 1908.000, 1936.000, ... , 1992.000
coef  :
[1] -0.2481833 -0.0700000  0.1300000  0.1300000  0.2420000  0.5080043
empirical tau (over all): 105/113  = 0.9292035 (target tau : 0.9)
> 
> which(hot.idx  <- temp >= a90$fit)
 [1]  10  18  21  22  36  47  61  68  74 101 102
> which(cold.idx <- temp <= a10$fit)
 [1]   5   8  25  28  38  39  71  77  85  86  92  97 113
> normal.idx <- !hot.idx & !cold.idx
> 
> (pa50 <- predict(a50,year,interval = "both"))
          z          fit       cb.lo        cb.up        ci.lo        ci.up
  [1,] 1880 -0.406780627 -0.56664804 -0.246913209 -0.496092124 -0.317469130
  [2,] 1881 -0.403390313 -0.55607270 -0.250707924 -0.488687823 -0.318092803
  [3,] 1882 -0.400000000 -0.54561314 -0.254386861 -0.481348204 -0.318651796
  [4,] 1883 -0.396609687 -0.53528706 -0.257932312 -0.474083158 -0.319136215
  [5,] 1884 -0.393219373 -0.52511553 -0.261323217 -0.466904451 -0.319534295
  [6,] 1885 -0.389829060 -0.51512364 -0.264534480 -0.459826102 -0.319832018
  [7,] 1886 -0.386438746 -0.50534132 -0.267536177 -0.452864830 -0.320012663
  [8,] 1887 -0.383048433 -0.49580420 -0.270292661 -0.446040548 -0.320056318
  [9,] 1888 -0.379658120 -0.48655462 -0.272761623 -0.439376893 -0.319939346
 [10,] 1889 -0.376267806 -0.47764242 -0.274893196 -0.432901724 -0.319633889
 [11,] 1890 -0.372877493 -0.46912569 -0.276629293 -0.426647491 -0.319107495
 [12,] 1891 -0.369487179 -0.46107088 -0.277903480 -0.420651309 -0.318323050
 [13,] 1892 -0.366096866 -0.45355192 -0.278641815 -0.414954485 -0.317239247
 [14,] 1893 -0.362706553 -0.44664791 -0.278765195 -0.409601213 -0.315811892
 [15,] 1894 -0.359316239 -0.44043881 -0.278193672 -0.404636155 -0.313996324
 [16,] 1895 -0.355925926 -0.43499896 -0.276852896 -0.400100847 -0.311751004
 [17,] 1896 -0.352535613 -0.43038913 -0.274682090 -0.396029244 -0.309041981
 [18,] 1897 -0.349145299 -0.42664854 -0.271642063 -0.392443240 -0.305847358
 [19,] 1898 -0.345754986 -0.42378886 -0.267721108 -0.389349375 -0.302160597
 [20,] 1899 -0.342364672 -0.42179246 -0.262936880 -0.386737785 -0.297991559
 [21,] 1900 -0.338974359 -0.42061513 -0.257333584 -0.384583776 -0.293364942
 [22,] 1901 -0.335584046 -0.42019263 -0.250975466 -0.382851456 -0.288316635
 [23,] 1902 -0.332193732 -0.42044882 -0.243938640 -0.381498303 -0.282889162
 [24,] 1903 -0.328803419 -0.42130350 -0.236303341 -0.380479492 -0.277127345
 [25,] 1904 -0.325413105 -0.42267832 -0.228147894 -0.379751267 -0.271074944
 [26,] 1905 -0.322022792 -0.42450075 -0.219544833 -0.379273106 -0.264772478
 [27,] 1906 -0.318632479 -0.42670605 -0.210558908 -0.379008836 -0.258256122
 [28,] 1907 -0.315242165 -0.42923784 -0.201246486 -0.378926966 -0.251557364
 [29,] 1908 -0.311851852 -0.43204789 -0.191655817 -0.379000542 -0.244703161
 [30,] 1909 -0.300000000 -0.41480234 -0.185197663 -0.364135448 -0.235864552
 [31,] 1910 -0.288148148 -0.39771387 -0.178582422 -0.349358112 -0.226938184
 [32,] 1911 -0.276296296 -0.38080611 -0.171786479 -0.334681728 -0.217910865
 [33,] 1912 -0.264444444 -0.36410656 -0.164782327 -0.320121661 -0.208767228
 [34,] 1913 -0.252592593 -0.34764708 -0.157538107 -0.305695711 -0.199489475
 [35,] 1914 -0.240740741 -0.33146425 -0.150017233 -0.291424315 -0.190057166
 [36,] 1915 -0.228888889 -0.31559954 -0.142178242 -0.277330640 -0.180447138
 [37,] 1916 -0.217037037 -0.30009906 -0.133975013 -0.263440449 -0.170633625
 [38,] 1917 -0.205185185 -0.28501278 -0.125357587 -0.249781654 -0.160588717
 [39,] 1918 -0.193333333 -0.27039287 -0.116273792 -0.236383400 -0.150283267
 [40,] 1919 -0.181481481 -0.25629112 -0.106671840 -0.223274619 -0.139688344
 [41,] 1920 -0.169629630 -0.24275537 -0.096503889 -0.210482040 -0.128777220
 [42,] 1921 -0.157777778 -0.22982531 -0.085730243 -0.198027838 -0.117527718
 [43,] 1922 -0.145925926 -0.21752832 -0.074323533 -0.185927303 -0.105924549
 [44,] 1923 -0.134074074 -0.20587616 -0.062271984 -0.174187014 -0.093961134
 [45,] 1924 -0.122222222 -0.19486353 -0.049580916 -0.162803999 -0.081640446
 [46,] 1925 -0.110370370 -0.18446869 -0.036272052 -0.151766121 -0.068974620
 [47,] 1926 -0.098518519 -0.17465618 -0.022380853 -0.141053570 -0.055983467
 [48,] 1927 -0.086666667 -0.16538077 -0.007952568 -0.130641068 -0.042692266
 [49,] 1928 -0.074814815 -0.15659169  0.006962056 -0.120500264 -0.029129366
 [50,] 1929 -0.062962963 -0.14823656  0.022310631 -0.110601890 -0.015324036
 [51,] 1930 -0.051111111 -0.14026433  0.038042111 -0.100917431 -0.001304792
 [52,] 1931 -0.039259259 -0.13262730  0.054108777 -0.091420226  0.012901707
 [53,] 1932 -0.027407407 -0.12528215  0.070467336 -0.082086090  0.027271275
 [54,] 1933 -0.015555556 -0.11819045  0.087079344 -0.072893546  0.041782435
 [55,] 1934 -0.003703704 -0.11131858  0.103911173 -0.063823807  0.056416400
 [56,] 1935  0.008148148 -0.10463741  0.120933709 -0.054860608  0.071156905
 [57,] 1936  0.020000000 -0.09812191  0.138121911 -0.045989961  0.085989961
 [58,] 1937  0.020000000 -0.09252728  0.132527277 -0.042864464  0.082864464
 [59,] 1938  0.020000000 -0.08713806  0.127138058 -0.039853724  0.079853724
 [60,] 1939  0.020000000 -0.08198682  0.121986821 -0.036975935  0.076975935
 [61,] 1940  0.020000000 -0.07711145  0.117111445 -0.034252259  0.074252259
 [62,] 1941  0.020000000 -0.07255553  0.112555534 -0.031707054  0.071707054
 [63,] 1942  0.020000000 -0.06836851  0.108368513 -0.029367934  0.069367934
 [64,] 1943  0.020000000 -0.06460517  0.104605166 -0.027265503  0.067265503
 [65,] 1944  0.020000000 -0.06132433  0.101324332 -0.025432634  0.065432634
 [66,] 1945  0.020000000 -0.05858647  0.098586468 -0.023903099  0.063903099
 [67,] 1946  0.020000000 -0.05644993  0.096449931 -0.022709502  0.062709502
 [68,] 1947  0.020000000 -0.05496615  0.094966151 -0.021880573  0.061880573
 [69,] 1948  0.020000000 -0.05417431  0.094174312 -0.021438205  0.061438205
 [70,] 1949  0.020000000 -0.05409660  0.094096602 -0.021394791  0.061394791
 [71,] 1950  0.020000000 -0.05473525  0.094735247 -0.021751577  0.061751577
 [72,] 1951  0.020000000 -0.05607221  0.096072208 -0.022498483  0.062498483
 [73,] 1952  0.020000000 -0.05807162  0.098071617 -0.023615473  0.063615473
 [74,] 1953  0.020000000 -0.06068424  0.100684243 -0.025075041  0.065075041
 [75,] 1954  0.020000000 -0.06385279  0.103852785 -0.026845179  0.066845179
 [76,] 1955  0.020000000 -0.06751688  0.107516884 -0.028892163  0.068892163
 [77,] 1956  0.020000000 -0.07161710  0.111617103 -0.031182791  0.071182791
 [78,] 1957  0.020000000 -0.07609763  0.116097632 -0.033685882  0.073685882
 [79,] 1958  0.020000000 -0.08090783  0.120907826 -0.036373144  0.076373144
 [80,] 1959  0.020000000 -0.08600281  0.126002814 -0.039219509  0.079219509
 [81,] 1960  0.020000000 -0.09134351  0.131343509 -0.042203140  0.082203140
 [82,] 1961  0.020000000 -0.09689624  0.136896237 -0.045305226  0.085305226
 [83,] 1962  0.020000000 -0.10263220  0.142632199 -0.048509678  0.088509678
 [84,] 1963  0.020000000 -0.10852687  0.148526867 -0.051802791  0.091802791
 [85,] 1964  0.020000000 -0.11455938  0.154559383 -0.055172915  0.095172915
 [86,] 1965  0.023333333 -0.09949144  0.146158110 -0.045283929  0.091950596
 [87,] 1966  0.026666667 -0.08574484  0.139078177 -0.036133123  0.089466456
 [88,] 1967  0.030000000 -0.07371834  0.133718336 -0.027943263  0.087943263
 [89,] 1968  0.033333333 -0.06387450  0.130541166 -0.020972773  0.087639440
 [90,] 1969  0.036666667 -0.05667119  0.130004526 -0.015477441  0.088810774
 [91,] 1970  0.040000000 -0.05244065  0.132440645 -0.011642870  0.091642870
 [92,] 1971  0.043333333 -0.05126748  0.137934145 -0.009516335  0.096183002
 [93,] 1972  0.046666667 -0.05295300  0.146286334 -0.008986835  0.102320168
 [94,] 1973  0.050000000 -0.05709606  0.157096061 -0.009830262  0.109830262
 [95,] 1974  0.053333333 -0.06322471  0.169891380 -0.011782959  0.118449626
 [96,] 1975  0.056666667 -0.07089788  0.184231215 -0.014598516  0.127931849
 [97,] 1976  0.060000000 -0.07975111  0.199751113 -0.018073326  0.138073326
 [98,] 1977  0.063333333 -0.08950238  0.216169051 -0.022049835  0.148716502
 [99,] 1978  0.066666667 -0.09994025  0.233273580 -0.026409915  0.159743249
[100,] 1979  0.093076912 -0.05703355  0.243187374  0.009216235  0.176937590
[101,] 1980  0.119487170 -0.01591485  0.254889185  0.043843510  0.195130830
[102,] 1981  0.145897427  0.02277337  0.269021486  0.077112967  0.214681887
[103,] 1982  0.172307684  0.05824351  0.286371858  0.108584618  0.236030750
[104,] 1983  0.198717942  0.08969037  0.307745510  0.137808624  0.259627259
[105,] 1984  0.225128199  0.11655261  0.333703789  0.164471383  0.285785014
[106,] 1985  0.251538456  0.13877507  0.364301839  0.188542090  0.314534823
[107,] 1986  0.277948714  0.15683812  0.399059305  0.210289097  0.345608330
[108,] 1987  0.304358971  0.17152357  0.437194371  0.230149176  0.378568766
[109,] 1988  0.330769228  0.18363669  0.477901770  0.248572195  0.412966262
[110,] 1989  0.357179485  0.19385160  0.520507375  0.265934762  0.448424209
[111,] 1990  0.383589743  0.20267737  0.564502119  0.282521274  0.484658211
[112,] 1991  0.410000000  0.21048096  0.609519045  0.298536734  0.521463266
[113,] 1992  0.436410257  0.21752288  0.655297634  0.314126683  0.558693831
> (pa10 <- predict(a10,year,interval = "both"))
          z          fit      cb.lo        cb.up      ci.lo        ci.up
  [1,] 1880 -0.551500000 -0.9007086 -0.202291394 -0.7465888 -0.356411197
  [2,] 1881 -0.547000000 -0.8805139 -0.213486111 -0.7333208 -0.360679204
  [3,] 1882 -0.542500000 -0.8605721 -0.224427926 -0.7201941 -0.364805925
  [4,] 1883 -0.538000000 -0.8409218 -0.235078158 -0.7072302 -0.368769750
  [5,] 1884 -0.533500000 -0.8216092 -0.245390806 -0.6944550 -0.372544981
  [6,] 1885 -0.529000000 -0.8026889 -0.255311052 -0.6818990 -0.376100992
  [7,] 1886 -0.524500000 -0.7842265 -0.264773528 -0.6695987 -0.379401266
  [8,] 1887 -0.520000000 -0.7662996 -0.273700370 -0.6575977 -0.382402303
  [9,] 1888 -0.515500000 -0.7490008 -0.281999159 -0.6459475 -0.385052472
 [10,] 1889 -0.511000000 -0.7324390 -0.289560968 -0.6347091 -0.387290919
 [11,] 1890 -0.506500000 -0.7167411 -0.296258914 -0.6239532 -0.389046761
 [12,] 1891 -0.502000000 -0.7020521 -0.301947879 -0.6137611 -0.390238926
 [13,] 1892 -0.497500000 -0.6885336 -0.306466350 -0.6042228 -0.390777183
 [14,] 1893 -0.493000000 -0.6763585 -0.309641534 -0.5954350 -0.390565000
 [15,] 1894 -0.488500000 -0.6657012 -0.311298798 -0.5874952 -0.389504815
 [16,] 1895 -0.484000000 -0.6567243 -0.311275733 -0.5804941 -0.387505899
 [17,] 1896 -0.479500000 -0.6495604 -0.309439581 -0.5745059 -0.384494084
 [18,] 1897 -0.475000000 -0.6442953 -0.305704734 -0.5695785 -0.380421544
 [19,] 1898 -0.470500000 -0.6409544 -0.300045620 -0.5657260 -0.375273994
 [20,] 1899 -0.466000000 -0.6394992 -0.292500803 -0.5629270 -0.369072977
 [21,] 1900 -0.461500000 -0.6398332 -0.283166844 -0.5611276 -0.361872438
 [22,] 1901 -0.457000000 -0.6418159 -0.272184078 -0.5602492 -0.353750777
 [23,] 1902 -0.452500000 -0.6452812 -0.259718769 -0.5601991 -0.344800880
 [24,] 1903 -0.448000000 -0.6500538 -0.245946175 -0.5608793 -0.335120654
 [25,] 1904 -0.443500000 -0.6559626 -0.231037389 -0.5621943 -0.324805684
 [26,] 1905 -0.439000000 -0.6628491 -0.215150852 -0.5640555 -0.313944484
 [27,] 1906 -0.434500000 -0.6705720 -0.198428001 -0.5663839 -0.302616069
 [28,] 1907 -0.430000000 -0.6790080 -0.180991961 -0.5691108 -0.290889224
 [29,] 1908 -0.425500000 -0.6880519 -0.162948128 -0.5721772 -0.278822829
 [30,] 1909 -0.415303571 -0.6660736 -0.164533499 -0.5553987 -0.275208418
 [31,] 1910 -0.405107143 -0.6444386 -0.165775734 -0.5388120 -0.271402311
 [32,] 1911 -0.394910714 -0.6231982 -0.166623249 -0.5224457 -0.267375689
 [33,] 1912 -0.384714286 -0.6024126 -0.167015962 -0.5063336 -0.263094988
 [34,] 1913 -0.374517857 -0.5821514 -0.166884277 -0.4905144 -0.258521327
 [35,] 1914 -0.364321429 -0.5624946 -0.166148280 -0.4750328 -0.253610061
 [36,] 1915 -0.354125000 -0.5435326 -0.164717398 -0.4599394 -0.248310591
 [37,] 1916 -0.343928571 -0.5253663 -0.162490889 -0.4452905 -0.242566636
 [38,] 1917 -0.333732143 -0.5081047 -0.159359624 -0.4311471 -0.236317230
 [39,] 1918 -0.323535714 -0.4918618 -0.155209639 -0.4175727 -0.229498706
 [40,] 1919 -0.313339286 -0.4767508 -0.149927811 -0.4046307 -0.222047867
 [41,] 1920 -0.303142857 -0.4628761 -0.143409635 -0.3923794 -0.213906330
 [42,] 1921 -0.292946429 -0.4503245 -0.135568399 -0.3808672 -0.205025653
 [43,] 1922 -0.282750000 -0.4391557 -0.126344322 -0.3701276 -0.195372438
 [44,] 1923 -0.272553571 -0.4293955 -0.115711684 -0.3601748 -0.184932317
 [45,] 1924 -0.262357143 -0.4210322 -0.103682100 -0.3510025 -0.173711778
 [46,] 1925 -0.252160714 -0.4140184 -0.090303028 -0.3425841 -0.161737335
 [47,] 1926 -0.241964286 -0.4082766 -0.075651923 -0.3348763 -0.149052258
 [48,] 1927 -0.231767857 -0.4037081 -0.059827626 -0.3278239 -0.135711766
 [49,] 1928 -0.221571429 -0.4002019 -0.042940989 -0.3213651 -0.121777787
 [50,] 1929 -0.211375000 -0.3976436 -0.025106445 -0.3154357 -0.107314250
 [51,] 1930 -0.201178571 -0.3959216 -0.006435497 -0.3099737 -0.092383448
 [52,] 1931 -0.190982143 -0.3949319  0.012967619 -0.3049207 -0.077043614
 [53,] 1932 -0.180785714 -0.3945798  0.033008335 -0.3002239 -0.061347577
 [54,] 1933 -0.170589286 -0.3947812  0.053602676 -0.2958363 -0.045342254
 [55,] 1934 -0.160392857 -0.3954629  0.074677187 -0.2917170 -0.029068678
 [56,] 1935 -0.150196429 -0.3965611  0.096168271 -0.2878305 -0.012562379
 [57,] 1936 -0.140000000 -0.3980212  0.118021230 -0.2841461  0.004146084
 [58,] 1937 -0.140000000 -0.3858005  0.105800515 -0.2773189 -0.002681138
 [59,] 1938 -0.140000000 -0.3740285  0.094028498 -0.2707423 -0.009257691
 [60,] 1939 -0.140000000 -0.3627763  0.082776323 -0.2644562 -0.015543828
 [61,] 1940 -0.140000000 -0.3521267  0.072126729 -0.2585067 -0.021493328
 [62,] 1941 -0.140000000 -0.3421750  0.062174962 -0.2529470 -0.027052980
 [63,] 1942 -0.140000000 -0.3330290  0.053028983 -0.2478375 -0.032162471
 [64,] 1943 -0.140000000 -0.3248085  0.044808464 -0.2432451 -0.036754944
 [65,] 1944 -0.140000000 -0.3176419  0.037641931 -0.2392414 -0.040758598
 [66,] 1945 -0.140000000 -0.3116614  0.031661439 -0.2359003 -0.044099658
 [67,] 1946 -0.140000000 -0.3069945  0.026994464 -0.2332931 -0.046706909
 [68,] 1947 -0.140000000 -0.3037533  0.023753349 -0.2314824 -0.048517590
 [69,] 1948 -0.140000000 -0.3020237  0.022023685 -0.2305161 -0.049483884
 [70,] 1949 -0.140000000 -0.3018539  0.021853937 -0.2304213 -0.049578715
 [71,] 1950 -0.140000000 -0.3032490  0.023248970 -0.2312006 -0.048799366
 [72,] 1951 -0.140000000 -0.3061694  0.026169379 -0.2328321 -0.047167851
 [73,] 1952 -0.140000000 -0.3105368  0.030536817 -0.2352721 -0.044727939
 [74,] 1953 -0.140000000 -0.3162437  0.036243742 -0.2384603 -0.041539710
 [75,] 1954 -0.140000000 -0.3231650  0.043164991 -0.2423269 -0.037673086
 [76,] 1955 -0.140000000 -0.3311687  0.051168717 -0.2467983 -0.033201726
 [77,] 1956 -0.140000000 -0.3401251  0.060125086 -0.2518018 -0.028198163
 [78,] 1957 -0.140000000 -0.3499122  0.069912193 -0.2572695 -0.022730501
 [79,] 1958 -0.140000000 -0.3604194  0.080419405 -0.2631395 -0.016860543
 [80,] 1959 -0.140000000 -0.3715487  0.091548714 -0.2693570 -0.010643046
 [81,] 1960 -0.140000000 -0.3832147  0.103214733 -0.2758743 -0.004125710
 [82,] 1961 -0.140000000 -0.3953439  0.115343912 -0.2826504  0.002650374
 [83,] 1962 -0.140000000 -0.4078733  0.127873341 -0.2896501  0.009650062
 [84,] 1963 -0.140000000 -0.4207494  0.140749439 -0.2968434  0.016843420
 [85,] 1964 -0.140000000 -0.4339266  0.153926650 -0.3042050  0.024204998
 [86,] 1965 -0.135714286 -0.4040083  0.132579714 -0.2855994  0.014170781
 [87,] 1966 -0.131428571 -0.3769762  0.114119066 -0.2686062  0.005749018
 [88,] 1967 -0.127142857 -0.3537014  0.099415726 -0.2537120 -0.000573689
 [89,] 1968 -0.122857143 -0.3351944  0.089480131 -0.2414814 -0.004232848
 [90,] 1969 -0.118571429 -0.3224553  0.085312415 -0.2324731 -0.004669725
 [91,] 1970 -0.114285714 -0.3162097  0.087638288 -0.2270925 -0.001478896
 [92,] 1971 -0.110000000 -0.3166426  0.096642592 -0.2254429  0.005442905
 [93,] 1972 -0.105714286 -0.3233199  0.111891312 -0.2272818  0.015853210
 [94,] 1973 -0.101428571 -0.3353653  0.132508191 -0.2321196  0.029262489
 [95,] 1974 -0.097142857 -0.3517480  0.157462324 -0.2393805  0.045094818
 [96,] 1975 -0.092857143 -0.3715045  0.185790243 -0.2485262  0.062811944
 [97,] 1976 -0.088571429 -0.3938387  0.216695847 -0.2591120  0.081969121
 [98,] 1977 -0.084285714 -0.4181345  0.249563101 -0.2707936  0.102222191
 [99,] 1978 -0.080000000 -0.4439301  0.283930117 -0.2833131  0.123313119
[100,] 1979 -0.065000005 -0.3928959  0.262895858 -0.2481822  0.118182226
[101,] 1980 -0.050000005 -0.3457673  0.245767260 -0.2152333  0.115233271
[102,] 1981 -0.035000004 -0.3039477  0.233947738 -0.1852503  0.115250283
[103,] 1982 -0.020000004 -0.2691577  0.229157651 -0.1591944  0.119194357
[104,] 1983 -0.005000003 -0.2431559  0.233155873 -0.1380481  0.128048106
[105,] 1984  0.009999997 -0.2271686  0.247168590 -0.1224966  0.142496551
[106,] 1985  0.024999997 -0.2213163  0.271316252 -0.1126070  0.162606982
[107,] 1986  0.039999998 -0.2245496  0.304549593 -0.1077932  0.187793216
[108,] 1987  0.054999998 -0.2351608  0.345160841 -0.1071012  0.217101191
[109,] 1988  0.069999998 -0.2513910  0.391391002 -0.1095482  0.249548226
[110,] 1989  0.084999999 -0.2717675  0.441767535 -0.1143117  0.284311672
[111,] 1990  0.099999999 -0.2951785  0.495178450 -0.1207703  0.320770306
[112,] 1991  0.115000000 -0.3208222  0.550822185 -0.1284763  0.358476326
[113,] 1992  0.130000000 -0.3481297  0.608129670 -0.1371118  0.397111817
> (pa90 <- predict(a90,year,interval = "both"))
          z          fit        cb.lo        cb.up        ci.lo        ci.up
  [1,] 1880 -0.248181818 -0.450870842 -0.045492794 -0.361416024 -0.134947612
  [2,] 1881 -0.241818182 -0.435397617 -0.048238747 -0.349963226 -0.133673137
  [3,] 1882 -0.235454545 -0.420071182 -0.050837909 -0.338592435 -0.132316656
  [4,] 1883 -0.229090909 -0.404913989 -0.053267829 -0.327316192 -0.130865626
  [5,] 1884 -0.222727273 -0.389952737 -0.055501808 -0.316149414 -0.129305131
  [6,] 1885 -0.216363636 -0.375219245 -0.057508027 -0.305109876 -0.127617397
  [7,] 1886 -0.210000000 -0.360751454 -0.059248546 -0.294218774 -0.125781226
  [8,] 1887 -0.203636364 -0.346594558 -0.060678170 -0.283501357 -0.123771370
  [9,] 1888 -0.197272727 -0.332802198 -0.061743257 -0.272987592 -0.121557863
 [10,] 1889 -0.190909091 -0.319437599 -0.062380583 -0.262712799 -0.119105383
 [11,] 1890 -0.184545455 -0.306574407 -0.062516502 -0.252718123 -0.116372787
 [12,] 1891 -0.178181818 -0.294296852 -0.062066784 -0.243050618 -0.113313019
 [13,] 1892 -0.171818182 -0.282698679 -0.060937684 -0.233762656 -0.109873707
 [14,] 1893 -0.165454545 -0.271880183 -0.059028908 -0.224910269 -0.105998822
 [15,] 1894 -0.159090909 -0.261942723 -0.056239095 -0.216550081 -0.101631737
 [16,] 1895 -0.152727273 -0.252980567 -0.052473979 -0.208734756 -0.096719790
 [17,] 1896 -0.146363636 -0.245070769 -0.047656503 -0.201507342 -0.091219931
 [18,] 1897 -0.140000000 -0.238263020 -0.041736980 -0.194895597 -0.085104403
 [19,] 1898 -0.133636364 -0.232572161 -0.034700566 -0.188907814 -0.078364913
 [20,] 1899 -0.127272727 -0.227975809 -0.026569645 -0.183531489 -0.071013966
 [21,] 1900 -0.120909091 -0.224417918 -0.017400263 -0.178735310 -0.063082872
 [22,] 1901 -0.114545455 -0.221817035 -0.007273875 -0.174473772 -0.054617137
 [23,] 1902 -0.108181818 -0.220076654  0.003713017 -0.170692963 -0.045670674
 [24,] 1903 -0.101818182 -0.219095053  0.015458689 -0.167336053 -0.036300311
 [25,] 1904 -0.095454545 -0.218772925  0.027863834 -0.164347564 -0.026561527
 [26,] 1905 -0.089090909 -0.219018307  0.040836488 -0.161676120 -0.016505698
 [27,] 1906 -0.082727273 -0.219749105  0.054294559 -0.159275859 -0.006178686
 [28,] 1907 -0.076363636 -0.220893855  0.068166583 -0.157106857  0.004379584
 [29,] 1908 -0.070000000 -0.222391384  0.082391384 -0.155134937  0.015134937
 [30,] 1909 -0.062857143 -0.208410089  0.082695803 -0.144171720  0.018457434
 [31,] 1910 -0.055714286 -0.194627957  0.083199386 -0.133319767  0.021891196
 [32,] 1911 -0.048571429 -0.181074931  0.083932074 -0.122595806  0.025452949
 [33,] 1912 -0.041428571 -0.167785884  0.084928741 -0.112019320  0.029162177
 [34,] 1913 -0.034285714 -0.154801208  0.086229780 -0.101612874  0.033041445
 [35,] 1914 -0.027142857 -0.142167291  0.087881576 -0.091402382  0.037116668
 [36,] 1915 -0.020000000 -0.129936701  0.089936701 -0.081417213  0.041417213
 [37,] 1916 -0.012857143 -0.118167912  0.092453626 -0.071690034  0.045975748
 [38,] 1917 -0.005714286 -0.106924264  0.095495693 -0.062256230  0.050827659
 [39,] 1918  0.001428571 -0.096271907  0.099129050 -0.053152757  0.056009899
 [40,] 1919  0.008571429 -0.086276498  0.103419355 -0.044416293  0.061559151
 [41,] 1920  0.015714286 -0.076998695  0.108427267 -0.036080728  0.067509299
 [42,] 1921  0.022857143 -0.068488828  0.114203114 -0.028174177  0.073888463
 [43,] 1922  0.030000000 -0.060781595  0.120781595 -0.020716026  0.080716026
 [44,] 1923  0.037142857 -0.053891924  0.128177639 -0.013714614  0.088000328
 [45,] 1924  0.044285714 -0.047813074  0.136384503 -0.007166175  0.095737603
 [46,] 1925  0.051428571 -0.042517500  0.145374642 -0.001055320  0.103912463
 [47,] 1926  0.058571429 -0.037960243  0.155103100  0.004643066  0.112499791
 [48,] 1927  0.065714286 -0.034083935  0.165512506  0.009961034  0.121467538
 [49,] 1928  0.072857143 -0.030824235  0.176538521  0.014934527  0.130779759
 [50,] 1929  0.080000000 -0.028114723  0.188114723  0.019600653  0.140399347
 [51,] 1930  0.087142857 -0.025890679  0.200176394  0.023995566  0.150290148
 [52,] 1931  0.094285714 -0.024091604  0.212663032  0.028153068  0.160418361
 [53,] 1932  0.101428571 -0.022662607  0.225519749  0.032103821  0.170753322
 [54,] 1933  0.108571429 -0.021554946  0.238697803  0.035875057  0.181267801
 [55,] 1934  0.115714286 -0.020725988  0.252154560  0.039490592  0.191937979
 [56,] 1935  0.122857143 -0.020138819  0.265853105  0.042971050  0.202743236
 [57,] 1936  0.130000000 -0.019761691  0.279761691  0.046334167  0.213665833
 [58,] 1937  0.130000000 -0.012668495  0.272668495  0.050296850  0.209703150
 [59,] 1938  0.130000000 -0.005835736  0.265835736  0.054114038  0.205885962
 [60,] 1939  0.130000000  0.000695296  0.259304704  0.057762662  0.202237338
 [61,] 1940  0.130000000  0.006876575  0.253123425  0.061215894  0.198784106
 [62,] 1941  0.130000000  0.012652819  0.247347181  0.064442849  0.195557151
 [63,] 1942  0.130000000  0.017961363  0.242038637  0.067408520  0.192591480
 [64,] 1943  0.130000000  0.022732749  0.237267251  0.070074101  0.189925899
 [65,] 1944  0.130000000  0.026892376  0.233107624  0.072397918  0.187602082
 [66,] 1945  0.130000000  0.030363596  0.229636404  0.074337149  0.185662851
 [67,] 1946  0.130000000  0.033072420  0.226927580  0.075850460  0.184149540
 [68,] 1947  0.130000000  0.034953641  0.225046359  0.076901422  0.183098578
 [69,] 1948  0.130000000  0.035957579  0.224042421  0.077462282  0.182537718
 [70,] 1949  0.130000000  0.036056105  0.223943895  0.077517324  0.182482676
 [71,] 1950  0.130000000  0.035246395  0.224753605  0.077064972  0.182935028
 [72,] 1951  0.130000000  0.033551319  0.226448681  0.076118001  0.183881999
 [73,] 1952  0.130000000  0.031016354  0.228983646  0.074701818  0.185298182
 [74,] 1953  0.130000000  0.027703919  0.232296081  0.072851294  0.187148706
 [75,] 1954  0.130000000  0.023686660  0.236313340  0.070607013  0.189392987
 [76,] 1955  0.130000000  0.019041106  0.240958894  0.068011729  0.191988271
 [77,] 1956  0.130000000  0.013842615  0.246157385  0.065107541  0.194892459
 [78,] 1957  0.130000000  0.008161945  0.251838055  0.061933979  0.198066021
 [79,] 1958  0.130000000  0.002063307  0.257936693  0.058526915  0.201473085
 [80,] 1959  0.130000000 -0.004396409  0.264396409  0.054918131  0.205081869
 [81,] 1960  0.130000000 -0.011167646  0.271167646  0.051135314  0.208864686
 [82,] 1961  0.130000000 -0.018207711  0.278207711  0.047202313  0.212797687
 [83,] 1962  0.130000000 -0.025480092  0.285480092  0.043139526  0.216860474
 [84,] 1963  0.130000000 -0.032953687  0.292953687  0.038964329  0.221035671
 [85,] 1964  0.130000000 -0.040602055  0.300602055  0.034691493  0.225308507
 [86,] 1965  0.138000000 -0.017724252  0.293724252  0.051003124  0.224996877
 [87,] 1966  0.146000001  0.003478281  0.288521720  0.066378848  0.225621153
 [88,] 1967  0.154000001  0.022499983  0.285500019  0.080536230  0.227463772
 [89,] 1968  0.162000002  0.038754371  0.285245632  0.093147625  0.230852378
 [90,] 1969  0.170000002  0.051660945  0.288339059  0.103888730  0.236111274
 [91,] 1970  0.178000002  0.060798484  0.295201521  0.112524228  0.243475777
 [92,] 1971  0.186000003  0.066059702  0.305940304  0.118994181  0.253005825
 [93,] 1972  0.194000003  0.067696512  0.320303495  0.123439322  0.264560684
 [94,] 1973  0.202000004  0.066217514  0.337782493  0.126143788  0.277856219
 [95,] 1974  0.210000004  0.062221069  0.357778939  0.127441857  0.292558151
 [96,] 1975  0.218000004  0.056266400  0.379733609  0.127645944  0.308354064
 [97,] 1976  0.226000005  0.048815579  0.403184430  0.127014192  0.324985817
 [98,] 1977  0.234000005  0.040226171  0.427773839  0.125746357  0.342253653
 [99,] 1978  0.242000006  0.030766265  0.453233746  0.123992210  0.360007801
[100,] 1979  0.261000000  0.070681401  0.451318599  0.154676653  0.367323347
[101,] 1980  0.280000000  0.108329608  0.451670392  0.184094657  0.375905343
[102,] 1981  0.299000000  0.142896300  0.455103700  0.211791141  0.386208859
[103,] 1982  0.318000000  0.173382940  0.462617060  0.237208265  0.398791735
[104,] 1983  0.337000000  0.198768635  0.475231365  0.259775696  0.414224304
[105,] 1984  0.356000000  0.218341678  0.493658322  0.279095832  0.432904168
[106,] 1985  0.375000000  0.232032157  0.517967843  0.295129616  0.454870384
[107,] 1986  0.394000000  0.240449090  0.547550910  0.308217282  0.479782718
[108,] 1987  0.413000000  0.244583709  0.581416291  0.318912592  0.507087408
[109,] 1988  0.432000000  0.245456978  0.618543022  0.327785916  0.536214084
[110,] 1989  0.451000000  0.243923592  0.658076408  0.335314739  0.566685261
[111,] 1990  0.470000000  0.240628979  0.699371021  0.341859636  0.598140364
[112,] 1991  0.489000000  0.236038384  0.741961616  0.347680519  0.630319481
[113,] 1992  0.508000000  0.230482108  0.785517892  0.352961915  0.663038085
> 
> plot(year, temp, type = "n", ylab = "Temperature (C)", ylim = c(-.7,.6))
> lines(pa50, col = 2)
> lines(pa10, col = 3)
> lines(pa90, col = 3)
> points(year, temp, pch = c(1,3)[2 - normal.idx])
> 
> text(year[hot.idx], temp[hot.idx] + .03, labels = year[hot.idx])
> text(year[cold.idx],temp[cold.idx]- .03, labels = year[cold.idx])
> 
> ### Codes for Figure 1b. -- UNconstrained
> 
> ## (Pin Ng. had these commented out)
> 
> a50 <- cobs(year, temp, knots.add = TRUE, degree = 1, constraint = "none")

 Performing general knot selection ...
  N[rq,L1]= (113, 0); ([ei]qc= 0,0, vars=2)  _fixed_ (tau,lam)= (0.5, 1):
  N[rq,L1]= (113, 0); ([ei]qc= 0,0, vars=3)  _fixed_ (tau,lam)= (0.5, 1):
  N[rq,L1]= (113, 0); ([ei]qc= 0,0, vars=4)  _fixed_ (tau,lam)= (0.5, 1):
  N[rq,L1]= (113, 0); ([ei]qc= 0,0, vars=5)  _fixed_ (tau,lam)= (0.5, 1):
  N[rq,L1]= (113, 0); ([ei]qc= 0,0, vars=6)  _fixed_ (tau,lam)= (0.5, 1):

 WARNING! Since the number of  6  knots selected by  aic  reached the
   upper bound during general knot selection, you might want to rerun
   cobs with a larger number of knots. 

 Deleting unnecessary knots ...
  N[rq,L1]= (113, 0); ([ei]qc= 0,0, vars=5)  _fixed_ (tau,lam)= (0.5, 1):
  N[rq,L1]= (113, 0); ([ei]qc= 0,0, vars=5)  _fixed_ (tau,lam)= (0.5, 1):
  N[rq,L1]= (113, 0); ([ei]qc= 0,0, vars=5)  _fixed_ (tau,lam)= (0.5, 1):
  N[rq,L1]= (113, 0); ([ei]qc= 0,0, vars=5)  _fixed_ (tau,lam)= (0.5, 1):
  N[rq,L1]= (113, 0); ([ei]qc= 0,0, vars=4)  _fixed_ (tau,lam)= (0.5, 1):
  N[rq,L1]= (113, 0); ([ei]qc= 0,0, vars=4)  _fixed_ (tau,lam)= (0.5, 1):
  N[rq,L1]= (113, 0); ([ei]qc= 0,0, vars=4)  _fixed_ (tau,lam)= (0.5, 1):

 Searching for missing knots ...
  N[rq,L1]= (113, 0); ([ei]qc= 0,0, vars=6)  _fixed_ (tau,lam)= (0.5, 1):
  N[rq,L1]= (113, 0); ([ei]qc= 0,0, vars=6)  _fixed_ (tau,lam)= (0.5, 1):
  N[rq,L1]= (113, 0); ([ei]qc= 0,0, vars=6)  _fixed_ (tau,lam)= (0.5, 1):
  N[rq,L1]= (113, 0); ([ei]qc= 0,0, vars=6)  _fixed_ (tau,lam)= (0.5, 1):

 Computing the final fit ...
  N[rq,L1]= (113, 0); ([ei]qc= 0,0, vars=5)  _fixed_ (tau,lam)= (0.5, 1):
> ## As suggested in the warning message, we increase the number of knots to 9
> a50 <- cobs(year, temp, nknots = 9, knots.add = TRUE, degree = 1,
+             constraint = "none")

 You are using 9 knots instead of the default number of 6 knots.

 Performing general knot selection ...
  N[rq,L1]= (113, 0); ([ei]qc= 0,0, vars=2)  _fixed_ (tau,lam)= (0.5, 1):
  N[rq,L1]= (113, 0); ([ei]qc= 0,0, vars=3)  _fixed_ (tau,lam)= (0.5, 1):
  N[rq,L1]= (113, 0); ([ei]qc= 0,0, vars=4)  _fixed_ (tau,lam)= (0.5, 1):
  N[rq,L1]= (113, 0); ([ei]qc= 0,0, vars=5)  _fixed_ (tau,lam)= (0.5, 1):
  N[rq,L1]= (113, 0); ([ei]qc= 0,0, vars=6)  _fixed_ (tau,lam)= (0.5, 1):
  N[rq,L1]= (113, 0); ([ei]qc= 0,0, vars=7)  _fixed_ (tau,lam)= (0.5, 1):
  N[rq,L1]= (113, 0); ([ei]qc= 0,0, vars=8)  _fixed_ (tau,lam)= (0.5, 1):
  N[rq,L1]= (113, 0); ([ei]qc= 0,0, vars=9)  _fixed_ (tau,lam)= (0.5, 1):

 Deleting unnecessary knots ...
  N[rq,L1]= (113, 0); ([ei]qc= 0,0, vars=4)  _fixed_ (tau,lam)= (0.5, 1):
  N[rq,L1]= (113, 0); ([ei]qc= 0,0, vars=4)  _fixed_ (tau,lam)= (0.5, 1):
  N[rq,L1]= (113, 0); ([ei]qc= 0,0, vars=4)  _fixed_ (tau,lam)= (0.5, 1):

 Searching for missing knots ...
  N[rq,L1]= (113, 0); ([ei]qc= 0,0, vars=6)  _fixed_ (tau,lam)= (0.5, 1):
  N[rq,L1]= (113, 0); ([ei]qc= 0,0, vars=6)  _fixed_ (tau,lam)= (0.5, 1):
  N[rq,L1]= (113, 0); ([ei]qc= 0,0, vars=6)  _fixed_ (tau,lam)= (0.5, 1):
  N[rq,L1]= (113, 0); ([ei]qc= 0,0, vars=6)  _fixed_ (tau,lam)= (0.5, 1):

 Computing the final fit ...
  N[rq,L1]= (113, 0); ([ei]qc= 0,0, vars=5)  _fixed_ (tau,lam)= (0.5, 1):
> summary(a50)
COBS regression spline (degree = 1) from call:
  cobs(x = year, y = temp, constraint = "none", nknots = 9, degree = 1,     knots.add = TRUE)
{tau=0.5}-quantile;  dimensionality of fit: 5 (5)
knots[1 .. 5]: 1880, 1908, 1936, 1964, 1992
coef  :
[1] -0.40667730 -0.31320000  0.05640000 -0.05681818  0.28681957
R^2 = 72.6% ;  empirical tau (over all): 58/113  = 0.5132743 (target tau : 0.5)
> ## Here, we use the same knots sequence chosen for the 50th percentile
> (a10 <- cobs(year, temp, nknots = length(a50$knots), knots = a50$knot,
+              degree = 1, tau = 0.1, constraint = "none"))

 You are using 5 knots instead of the default number of 6 knots.
  N[rq,L1]= (113, 0); ([ei]qc= 0,0, vars=5)  _fixed_ (tau,lam)= (0.1, 1):
COBS regression spline (degree = 1) from call:
  cobs(x = year, y = temp, constraint = "none", knots = a50$knot,     nknots = length(a50$knots), degree = 1, tau = 0.1)
{tau=0.1}-quantile;  dimensionality of fit: 5 (5)
knots[1 .. 5]: 1880.000, 1908.000, 1936.000, 1964.000, 1992.000
> (a90 <- cobs(year, temp, nknots = length(a50$knots), knots = a50$knot,
+              degree = 1, tau = 0.9, constraint = "none"))

 You are using 5 knots instead of the default number of 6 knots.
  N[rq,L1]= (113, 0); ([ei]qc= 0,0, vars=5)  _fixed_ (tau,lam)= (0.9, 1):
COBS regression spline (degree = 1) from call:
  cobs(x = year, y = temp, constraint = "none", knots = a50$knot,     nknots = length(a50$knots), degree = 1, tau = 0.9)
{tau=0.9}-quantile;  dimensionality of fit: 5 (5)
knots[1 .. 5]: 1880.000, 1908.000, 1936.000, 1964.000, 1992.000
> which(hot.idx  <- temp >= a90$fit)
 [1]  10  18  21  22  47  61  68  74  78  79 102
> which(cold.idx <- temp <= a10$fit)
 [1]  5 25 38 39 50 54 71 77 85 92 97
> normal.idx <- (temp < a90$fit ) & (temp > a10$fit)
> 
> pa50 <- predict(a50,year,interval = "none")
> pa10 <- predict(a10,year,interval = "none")
> pa90 <- predict(a90,year,interval = "none")
> 
> plot(year, temp, type = "n",xlab = "Year", ylab = "Temperature (C)",
+      ylim = c(-.7,.6))
> lines(pa50, col = 2)
> lines(pa10, col = 3)
> lines(pa90, col = 3)
> points(year[normal.idx],temp[normal.idx])
> points(year[!normal.idx],temp[!normal.idx],pch = 3)
> text(year[hot.idx], temp[hot.idx]  + .03, labels = year[hot.idx])
> text(year[cold.idx],temp[cold.idx] - .03, labels = year[cold.idx])
> 
> 

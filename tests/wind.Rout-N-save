
R : Copyright 2002, The R Development Core Team
Version 1.5.0 Under development (unstable) (2002-04-17)

R is free software and comes with ABSOLUTELY NO WARRANTY.
You are welcome to redistribute it under certain conditions.
Type `license()' or `licence()' for distribution details.

R is a collaborative project with many contributors.
Type `contributors()' for more information.

Type `demo()' for some demos, `help()' for on-line help, or
`help.start()' for a HTML browser interface to help.
Type `q()' to quit R.

> library(cobs)
> data(DublinWind)
> attach(DublinWind)##-> speed & day (instead of "wind.x" & "DUB.")
> 
> if(!interactive()) postscript("wind.ps", horizontal = TRUE)
> 
> stopifnot(identical(day,c(rep(c(rep(1:365,3),1:366),4),
+                           rep(1:365,2))))
> nknots <- 13
> ## Compute the quadratic median smoothing B-spline using SIC
> ## lambda selection
> co.o50 <-
+  cobs(day,speed,knots.add = TRUE,constraint="periodic", nknots=nknots,
+       tau = .5,lambda = -1,factor = 3,method = "uniform")

 You are using 13 knots instead of the default number of 20 knots.

 Searching for optimal lambda. This may take a while.
   While you are waiting, here is something you can consider
   to speed up the process:
       (a) Use a smaller number of knots;
       (b) Increase `factor' to 2 or 3; 
       (c) Set lambda==0 to exclude the penalty term.
  N[rq,L1]= (1350, 1); ([ei]qc= 2,24, vars=15)
	 LAMBDA will be updated; (tau,lam)= (0.5, -1):

 WARNING!  Since the optimal lambda chosen by SIC reached the smoothest
    possible fit allowed by `lstart', you might want to rerun cobs with
    a larger `lstart' value to see if it makes a difference if you haven't
    done so.

  N[rq,L1]= (6574, 1); ([ei]qc= 2,24, vars=15)  _fixed_ (tau,lam)= (0.5, 1):
> summary(co.o50)
COBS smoothing spline (degree = 2) from call:
  cobs(x = day, y = speed, constraint = "periodic", nknots = nknots,     method = "uniform", tau = 0.5, lambda = -1, knots.add = TRUE,     factor = 3)
{tau=0.5}-quantile;  dimensionality of fit: 10 (10)
knots[1 .. 13]:   0.999999,  31.416667,  61.833333, ... , 366.000001
lambda = 7872, selected via SIC, out of 10 ones.
coef  :
 [1] 11.326907916 11.686638541 10.469015486 11.188476650  9.970853615
 [6]  7.845660660  7.657551903  7.580417267  6.889624929  8.135916789
[11]  8.907540763 10.691984374 10.967177362 11.326907963  0.002093752
R^2 = 8.63% ;  empirical tau (over all): 3288/6574  = 0.5001521 (target tau : 0.5)
> ## Since SIC chooses a lambda that corresponds to the smoothest
> ## possible fit, rerun cobs with a larger lstart value
> (lstart <- log(.Machine$double.xmax)^3) # 3.57 e9
[1] 357582497
> 
> co.o5 <-
+     cobs(day,speed,knots.add = TRUE,constraint = "periodic", nknots = nknots,
+          tau = .5,lambda = -1,factor = 3,method = "uniform",lstart = lstart)

 You are using 13 knots instead of the default number of 20 knots.

 Searching for optimal lambda. This may take a while.
   While you are waiting, here is something you can consider
   to speed up the process:
       (a) Use a smaller number of knots;
       (b) Increase `factor' to 2 or 3; 
       (c) Set lambda==0 to exclude the penalty term.
  N[rq,L1]= (1350, 1); ([ei]qc= 2,24, vars=15)
	 LAMBDA will be updated; (tau,lam)= (0.5, -1):
  N[rq,L1]= (6574, 1); ([ei]qc= 2,24, vars=15)  _fixed_ (tau,lam)= (0.5, 1):
> summary(co.o5)
COBS smoothing spline (degree = 2) from call:
  cobs(x = day, y = speed, constraint = "periodic", nknots = nknots,     method = "uniform", tau = 0.5, lambda = -1, knots.add = TRUE,     lstart = lstart, factor = 3)
{tau=0.5}-quantile;  dimensionality of fit: 10 (10)
knots[1 .. 13]:   0.999999,  31.416667,  61.833333, ... , 366.000001
lambda = 27702.22, selected via SIC, out of 42 ones.
coef  :
 [1] 1.138000e+01 1.148226e+01 1.081339e+01 1.078378e+01 9.880781e+00
 [6] 8.191982e+00 7.376578e+00 7.434570e+00 7.190882e+00 7.820591e+00
[11] 9.080092e+00 1.049168e+01 1.127774e+01 1.138000e+01 9.440342e-04
R^2 = 8.46% ;  empirical tau (over all): 3287/6574  = 0.5 (target tau : 0.5)
> (pc.5 <- predict(co.o5, interval = "both"))
                 z       fit    cb.lo     cb.up     ci.lo     ci.up
  [1,]   0.9999991 11.380000 5.918429 16.841571  8.877715 13.882285
  [2,]   4.6868678 11.398374 7.572026 15.224722  9.645287 13.151462
  [3,]   8.3737365 11.403917 8.533172 14.274661 10.088650 12.719183
  [4,]  12.0606052 11.396626 8.770885 14.022368 10.193611 12.599642
  [5,]  15.7474739 11.376504 8.595646 14.157362 10.102421 12.650588
  [6,]  19.4343426 11.343549 8.384420 14.302678  9.987789 12.699310
  [7,]  23.1212113 11.297763 8.326097 14.269428  9.936258 12.659267
  [8,]  26.8080801 11.239143 8.466092 14.012195  9.968636 12.509651
  [9,]  30.4949488 11.167692 8.731667 13.603717 10.051598 12.283786
 [10,]  34.1818175 11.089659 8.841391 13.337927 10.059588 12.119730
 [11,]  37.8686862 11.020324 8.671477 13.369170  9.944172 12.096476
 [12,]  41.5555549 10.960381 8.425490 13.495272  9.798990 12.121772
 [13,]  45.2424236 10.909831 8.239778 13.579884  9.686514 12.133148
 [14,]  48.9292923 10.868673 8.174335 13.563011  9.634229 12.103116
 [15,]  52.6161610 10.836907 8.242397 13.431418  9.648201 12.025614
 [16,]  56.3030297 10.814534 8.417994 13.211074  9.716530 11.912538
 [17,]  59.9898984 10.801553 8.616033 12.987073  9.800231 11.802875
 [18,]  63.6767671 10.795186 8.657436 12.932937  9.815750 11.774623
 [19,]  67.3636358 10.778766 8.485167 13.072365  9.727926 11.829606
 [20,]  71.0505045 10.749513 8.263036 13.235989  9.610303 11.888722
 [21,]  74.7373732 10.707427 8.092617 13.322238  9.509420 11.905434
 [22,]  78.4242419 10.652510 8.016021 13.288998  9.444571 11.860449
 [23,]  82.1111106 10.584760 8.040029 13.129491  9.418861 11.750659
 [24,]  85.7979793 10.504178 8.140350 12.868006  9.421162 11.587194
 [25,]  89.4848480 10.410764 8.245362 12.576165  9.418659 11.402869
 [26,]  93.1717167 10.304557 8.206346 12.402768  9.343236 11.265878
 [27,]  96.8585854 10.186444 7.944990 12.427897  9.159495 11.213393
 [28,] 100.5454541 10.056785 7.616036 12.497534  8.938526 11.175043
 [29,] 104.2323228  9.915581 7.329591 12.501571  8.730778 11.100383
 [30,] 107.9191916  9.762831 7.133200 12.392463  8.558034 10.967629
 [31,] 111.6060603  9.598537 7.038100 12.158973  8.425442 10.771632
 [32,] 115.2929290  9.422697 7.026689 11.818705  8.324937 10.520457
 [33,] 118.9797977  9.235312 7.040759 11.429865  8.229851 10.240773
 [34,] 122.6666664  9.036382 6.952481 11.120282  8.081617  9.991146
 [35,] 126.3535351  8.838095 6.646109 11.030080  7.833810  9.842379
 [36,] 130.0404038  8.652640 6.260048 11.045232  7.556445  9.748835
 [37,] 133.7272725  8.480018 5.922492 11.037543  7.308257  9.651779
 [38,] 137.4141412  8.320228 5.692175 10.948280  7.116154  9.524302
 [39,] 141.1010099  8.173270 5.587243 10.759297  6.988450  9.358089
 [40,] 144.7878786  8.039144 5.597266 10.481022  6.920369  9.157920
 [41,] 148.4747473  7.917851 5.676223 10.159479  6.890822  8.944880
 [42,] 152.1616160  7.809390 5.716595  9.902185  6.850551  8.768229
 [43,] 155.8484847  7.713761 5.563557  9.863966  6.728619  8.698903
 [44,] 159.5353534  7.630965 5.287975  9.973955  6.557496  8.704434
 [45,] 163.2222221  7.561000 5.036952 10.085049  6.404577  8.717424
 [46,] 166.9090908  7.503868 4.883240 10.124497  6.303196  8.704541
 [47,] 170.5959595  7.459569 4.853081 10.066057  6.265375  8.653763
 [48,] 174.2828282  7.428101 4.943038  9.913165  6.289539  8.566663
 [49,] 177.9696969  7.409466 5.117667  9.701265  6.359451  8.459481
 [50,] 181.6565656  7.403663 5.287899  9.519427  6.434300  8.373026
 [51,] 185.3434344  7.408534 5.292766  9.524303  6.439169  8.377899
 [52,] 189.0303031  7.411131 5.119322  9.702941  6.361111  8.461151
 [53,] 192.7171718  7.409296 4.924217  9.894374  6.270727  8.547865
 [54,] 196.4040405  7.403028 4.796520 10.009536  6.208825  8.597231
 [55,] 200.0909092  7.392328 4.771673 10.012982  6.191643  8.593012
 [56,] 203.7777779  7.377195 4.853113  9.901278  6.220756  8.533634
 [57,] 207.4646466  7.357630 5.014595  9.700665  6.284140  8.431120
 [58,] 211.1515153  7.333633 5.183367  9.483898  6.348462  8.318803
 [59,] 214.8383840  7.305742 5.212870  9.398615  6.346868  8.264617
 [60,] 218.5252527  7.285829 5.044132  9.527526  6.258768  8.312889
 [61,] 222.2121214  7.278747 4.836836  9.720659  6.159956  8.397539
 [62,] 225.8989901  7.284498 4.698493  9.870504  6.099689  8.469308
 [63,] 229.5858588  7.303081 4.675115  9.931048  6.099047  8.507116
 [64,] 233.2727275  7.334497 4.777115  9.891879  6.162801  8.506192
 [65,] 236.9595962  7.378744 4.986315  9.771174  6.282624  8.474865
 [66,] 240.6464649  7.435824 5.243919  9.627729  6.431577  8.440072
 [67,] 244.3333336  7.505737 5.421633  9.589840  6.550879  8.460594
 [68,] 248.0202023  7.586691 5.391565  9.781818  6.580968  8.592415
 [69,] 251.7070710  7.676899 5.280116 10.073683  6.578784  8.775015
 [70,] 255.3939397  7.776361 5.215134 10.337587  6.602904  8.949817
 [71,] 259.0808084  7.885075 5.254784 10.515366  6.679975  9.090174
 [72,] 262.7676772  8.003042 5.416606 10.589479  6.818035  9.188049
 [73,] 266.4545459  8.130263 5.689260 10.571266  7.011888  9.248638
 [74,] 270.1414146  8.266737 6.024993 10.508480  7.239655  9.293819
 [75,] 273.8282833  8.412464 6.313329 10.511598  7.450720  9.374208
 [76,] 277.5151520  8.565470 6.397910 10.733030  7.572376  9.558564
 [77,] 281.2020207  8.720930 6.354226 11.087634  7.636596  9.805264
 [78,] 284.8888894  8.878624 6.331085 11.426164  7.711438 10.045810
 [79,] 288.5757581  9.038553 6.399974 11.677132  7.829656 10.247450
 [80,] 292.2626268  9.200716 6.584909 11.816524  8.002253 10.399180
 [81,] 295.9494955  9.365114 6.878615 11.851614  8.225894 10.504334
 [82,] 299.6363642  9.531746 7.237966 11.825527  8.480823 10.582670
 [83,] 303.3232329  9.700613 7.559518 11.841708  8.719645 10.681582
 [84,] 307.0101016  9.870286 7.674278 12.066294  8.864159 10.876414
 [85,] 310.6969703 10.032197 7.620259 12.444135  8.927139 11.137256
 [86,] 314.3838390 10.184917 7.574719 12.795116  8.989023 11.380812
 [87,] 318.0707077 10.328447 7.622025 13.034869  9.088467 11.568427
 [88,] 321.7575764 10.462787 7.786577 13.138997  9.236649 11.688925
 [89,] 325.4444451 10.587936 8.052211 13.123661  9.426163 11.749709
 [90,] 329.1313138 10.703895 8.352838 13.054951  9.626730 11.781060
 [91,] 332.8181825 10.810663 8.541552 13.079774  9.771042 11.850284
 [92,] 336.5050512 10.908261 8.410974 13.405548  9.764099 12.052423
 [93,] 340.1919199 10.997133 8.142461 13.851805  9.689231 12.305036
 [94,] 343.8787887 11.077461 8.040099 14.114824  9.685857 12.469065
 [95,] 347.5656574 11.149245 8.163128 14.135361  9.781119 12.517370
 [96,] 351.2525261 11.212484 8.432232 13.992736  9.938678 12.486290
 [97,] 354.9393948 11.267179 8.578966 13.955392 10.035542 12.498817
 [98,] 358.6262635 11.313331 8.147159 14.479502  9.862711 12.763950
 [99,] 362.3131322 11.350937 6.901506 15.800369  9.312377 13.389498
[100,] 366.0000009 11.380000 4.955548 17.804452  8.436560 14.323440
> 
> co.o9 <- ## Compute the .9 quantile smoothing B-spline
+     cobs(day,speed,knots.add = TRUE,constraint = "periodic",nknots = nknots,
+          tau = .9,lambda = -1,factor = 3,method = "uniform")

 You are using 13 knots instead of the default number of 20 knots.

 Searching for optimal lambda. This may take a while.
   While you are waiting, here is something you can consider
   to speed up the process:
       (a) Use a smaller number of knots;
       (b) Increase `factor' to 2 or 3; 
       (c) Set lambda==0 to exclude the penalty term.
  N[rq,L1]= (1350, 1); ([ei]qc= 2,24, vars=15)
	 LAMBDA will be updated; (tau,lam)= (0.9, -1):
  N[rq,L1]= (6574, 1); ([ei]qc= 2,24, vars=15)  _fixed_ (tau,lam)= (0.9, 1):
> summary(co.o9)
COBS smoothing spline (degree = 2) from call:
  cobs(x = day, y = speed, constraint = "periodic", nknots = nknots,     method = "uniform", tau = 0.9, lambda = -1, knots.add = TRUE,     factor = 3)
{tau=0.9}-quantile;  dimensionality of fit: 11 (11)
knots[1 .. 13]:   0.999999,  31.416667,  61.833333, ... , 366.000001
lambda = 5915.971, selected via SIC, out of 10 ones.
coef  :
 [1] 18.948722971 19.625103137 17.672898873 19.025659053 17.535633496
 [6] 13.816047306 13.401425529 12.987041357 13.052189561 15.215871633
[11] 15.545606815 18.561457076 18.272342920 18.948723060  0.003572264
empirical tau (over all): 5918/6574  = 0.900213 (target tau : 0.9)
> (pc.9 <- predict(co.o9,interval = "both"))
                 z      fit     cb.lo    cb.up    ci.lo    ci.up
  [1,]   0.9999991 18.94872 10.080788 27.81666 15.02957 22.86787
  [2,]   4.6868678 19.08842 12.875586 25.30124 16.34268 21.83415
  [3,]   8.3737365 19.17955 14.518331 23.84077 17.11954 21.23956
  [4,]  12.0606052 19.22213 14.958718 23.48553 17.33793 21.10632
  [5,]  15.7474739 19.21614 14.700875 23.73141 17.22064 21.21165
  [6,]  19.4343426 19.16161 14.356877 23.96633 17.03817 21.28504
  [7,]  23.1212113 19.05851 14.233424 23.88359 16.92608 21.19094
  [8,]  26.8080801 18.90685 14.404259 23.40945 16.91695 20.89676
  [9,]  30.4949488 18.70664 14.751276 22.66201 16.95858 20.45470
 [10,]  34.1818175 18.48518 14.834680 22.13569 16.87186 20.09851
 [11,]  37.8686862 18.30925 14.495437 22.12307 16.62375 19.99475
 [12,]  41.5555549 18.18188 14.065982 22.29777 16.36287 20.00088
 [13,]  45.2424236 18.10306 13.767702 22.43841 16.18706 20.01905
 [14,]  48.9292923 18.07280 13.698010 22.44758 16.13938 20.00622
 [15,]  52.6161610 18.09109 13.878396 22.30379 16.22931 19.95288
 [16,]  56.3030297 18.15795 14.266696 22.04920 16.43823 19.87767
 [17,]  59.9898984 18.27336 14.724742 21.82198 16.70506 19.84166
 [18,]  63.6767671 18.42604 14.954985 21.89710 16.89202 19.96006
 [19,]  67.3636358 18.54825 14.824138 22.27236 16.90239 20.19410
 [20,]  71.0505045 18.62868 14.591400 22.66597 16.84442 20.41295
 [21,]  74.7373732 18.66735 14.421693 22.91301 16.79100 20.54371
 [22,]  78.4242419 18.66425 14.383397 22.94511 16.77235 20.55616
 [23,]  82.1111106 18.61939 14.487518 22.75126 16.79332 20.44545
 [24,]  85.7979793 18.53276 14.694616 22.37090 16.83651 20.22901
 [25,]  89.4848480 18.40436 14.888400 21.92031 16.85049 19.95822
 [26,]  93.1717167 18.23447 14.827612 21.64133 16.72882 19.74012
 [27,]  96.8585854 18.02929 14.389852 21.66873 16.42086 19.63773
 [28,] 100.5454541 17.79136 13.828322 21.75439 16.03991 19.54281
 [29,] 104.2323228 17.52067 13.321802 21.71953 15.66499 19.37634
 [30,] 107.9191916 17.21722 12.947492 21.48694 15.33023 19.10420
 [31,] 111.6060603 16.88101 12.723636 21.03838 15.04367 18.71834
 [32,] 115.2929290 16.51204 12.621652 20.40243 14.79270 18.23139
 [33,] 118.9797977 16.11032 12.547033 19.67361 14.53554 17.68510
 [34,] 122.6666664 15.67584 12.292218 19.05946 14.18046 17.17122
 [35,] 126.3535351 15.24926 11.690141 18.80838 13.67632 16.82220
 [36,] 130.0404038 14.87124 10.986394 18.75608 13.15435 16.58813
 [37,] 133.7272725 14.54177 10.389128 18.69442 12.70653 16.37702
 [38,] 137.4141412 14.26087  9.993707 18.52803 12.37501 16.14672
 [39,] 141.1010099 14.02852  9.829595 18.22744 12.17282 15.88422
 [40,] 144.7878786 13.84473  9.879858 17.80960 12.09247 15.59699
 [41,] 148.4747473 13.70949 10.069770 17.34922 12.10093 15.31806
 [42,] 152.1616160 13.62282 10.224754 17.02088 12.12106 15.12458
 [43,] 155.8484847 13.57104 10.079765 17.06232 12.02809 15.11400
 [44,] 159.5353534 13.52079  9.716487 17.32510 11.83949 15.20209
 [45,] 163.2222221 13.47054  9.372253 17.56883 11.65932 15.28177
 [46,] 166.9090908 13.42030  9.165190 17.67540 11.53977 15.30082
 [47,] 170.5959595 13.37005  9.137908 17.60220 11.49967 15.24043
 [48,] 174.2828282 13.31982  9.284826 17.35480 11.53657 15.10306
 [49,] 177.9696969 13.26958  9.548394 16.99077 11.62502 14.91414
 [50,] 181.6565656 13.21935  9.783989 16.65471 11.70110 14.73759
 [51,] 185.3434344 13.17000  9.734634 16.60537 11.65175 14.68825
 [52,] 189.0303031 13.12682  9.405614 16.84802 11.48225 14.77139
 [53,] 192.7171718 13.09068  9.055665 17.12569 11.30742 14.87394
 [54,] 196.4040405 13.06159  8.829409 17.29377 11.19119 14.93198
 [55,] 200.0909092 13.03954  8.784393 17.29469 11.15900 14.92009
 [56,] 203.7777779 13.02454  8.926196 17.12288 11.21329 14.83579
 [57,] 207.4646466 13.01658  9.212206 16.82096 11.33525 14.69791
 [58,] 211.1515153 13.01567  9.524295 16.50705 11.47267 14.55868
 [59,] 214.8383840 13.02255  9.624364 16.42074 11.52074 14.52437
 [60,] 218.5252527 13.05357  9.413738 16.69341 11.44496 14.66219
 [61,] 222.2121214 13.11543  9.150504 17.08035 11.36315 14.86771
 [62,] 225.8989901 13.20811  9.009225 17.40700 11.35243 15.06380
 [63,] 229.5858588 13.33163  9.064611 17.59865 11.44584 15.21743
 [64,] 233.2727275 13.48598  9.333570 17.63840 11.65084 15.32113
 [65,] 236.9595962 13.67117  9.786587 17.55575 11.95439 15.38794
 [66,] 240.6464649 13.88718 10.328193 17.44617 12.31430 15.46006
 [67,] 244.3333336 14.13403 10.750079 17.51798 12.63851 15.62955
 [68,] 248.0202023 14.38282 10.818603 17.94704 12.80763 15.95802
 [69,] 251.7070710 14.60467 10.713020 18.49632 12.88477 16.32457
 [70,] 255.3939397 14.79957 10.640917 18.95823 12.96167 16.63747
 [71,] 259.0808084 14.96753 10.696734 19.23832 13.08007 16.85499
 [72,] 262.7676772 15.10854 10.908952 19.30813 13.25255 16.96453
 [73,] 266.4545459 15.22261 11.259158 19.18606 13.47098 16.97424
 [74,] 270.1414146 15.30973 11.669817 18.94964 13.70108 16.91837
 [75,] 273.8282833 15.36991 11.961547 18.77826 13.86359 16.87622
 [76,] 277.5151520 15.42181 11.902355 18.94127 13.86640 16.97723
 [77,] 281.2020207 15.51111 11.668305 19.35392 13.81280 17.20943
 [78,] 284.8888894 15.63988 11.503448 19.77631 13.81180 17.46796
 [79,] 288.5757581 15.80811 11.523858 20.09236 13.91470 17.70152
 [80,] 292.2626268 16.01581 11.768528 20.26308 14.13874 17.89287
 [81,] 295.9494955 16.26297 12.225646 20.30029 14.47869 18.04725
 [82,] 299.6363642 16.54959 12.825190 20.27400 14.90361 18.19558
 [83,] 303.3232329 16.87569 13.399198 20.35217 15.33927 18.41211
 [84,] 307.0101016 17.23024 13.664590 20.79589 15.65442 18.80607
 [85,] 310.6969703 17.54724 13.630985 21.46350 15.81647 19.27801
 [86,] 314.3838390 17.81568 13.577512 22.05385 15.94264 19.68873
 [87,] 318.0707077 18.03557 13.641159 22.42998 16.09348 19.97766
 [88,] 321.7575764 18.20689 13.861541 22.55225 16.28648 20.12731
 [89,] 325.4444451 18.32966 14.212415 22.44691 16.51006 20.14926
 [90,] 329.1313138 18.40387 14.586471 22.22128 16.71679 20.09096
 [91,] 332.8181825 18.42953 14.745178 22.11387 16.80124 20.05781
 [92,] 336.5050512 18.40889 14.354056 22.46373 16.61687 20.20091
 [93,] 340.1919199 18.39194 13.756820 23.02706 16.34347 20.44041
 [94,] 343.8787887 18.39911 13.467357 23.33087 16.21954 20.57868
 [95,] 347.5656574 18.43041 13.581859 23.27895 16.28761 20.57320
 [96,] 351.2525261 18.48582 13.971538 23.00011 16.49075 20.48089
 [97,] 354.9393948 18.56536 14.200521 22.93021 16.63634 20.49439
 [98,] 358.6262635 18.66903 13.528125 23.80993 16.39703 20.94103
 [99,] 362.3131322 18.79681 11.572286 26.02134 15.60396 21.98967
[100,] 366.0000009 18.94872  8.517362 29.38008 14.33862 23.55882
> 
> co.o1 <- ## Compute the .1 quantile smoothing B-spline
+     cobs(day,speed,knots.add = TRUE,constraint = "periodic",nknots = nknots,
+          tau = .1,lambda = -1,factor = 3,method = "uniform")

 You are using 13 knots instead of the default number of 20 knots.

 Searching for optimal lambda. This may take a while.
   While you are waiting, here is something you can consider
   to speed up the process:
       (a) Use a smaller number of knots;
       (b) Increase `factor' to 2 or 3; 
       (c) Set lambda==0 to exclude the penalty term.
  N[rq,L1]= (1350, 1); ([ei]qc= 2,24, vars=15)
	 LAMBDA will be updated; (tau,lam)= (0.1, -1):
  N[rq,L1]= (6574, 1); ([ei]qc= 2,24, vars=15)  _fixed_ (tau,lam)= (0.1, 1):
> summary(co.o1)
COBS smoothing spline (degree = 2) from call:
  cobs(x = day, y = speed, constraint = "periodic", nknots = nknots,     method = "uniform", tau = 0.1, lambda = -1, knots.add = TRUE,     factor = 3)
{tau=0.1}-quantile;  dimensionality of fit: 11 (11)
knots[1 .. 13]:   0.999999,  31.416667,  61.833333, ... , 366.000001
lambda = 7458.52, selected via SIC, out of 8 ones.
coef  :
 [1] 4.8116017222 4.5242473916 4.6762640522 4.9917418292 4.4263606221
 [6] 3.2838332413 3.0595096049 3.4382230102 2.8987326712 3.2774460765
[11] 3.6105693977 4.7554608866 5.0989560181 4.8116016844 0.0009924664
empirical tau (over all): 655/6574  = 0.09963493 (target tau : 0.1)
> (pc.1 <- predict(co.o1, interval = "both"))
                 z      fit      cb.lo     cb.up    ci.lo    ci.up
  [1,]   0.9999991 4.811602 -0.1046299  9.727833 2.638892 6.984311
  [2,]   4.6868678 4.747279  1.3029928  8.191565 3.225090 6.269467
  [3,]   8.3737365 4.693633  2.1095335  7.277733 3.551600 5.835666
  [4,]  12.0606052 4.650665  2.2871041  7.014225 3.606098 5.695231
  [5,]  15.7474739 4.618374  2.1151855  7.121562 3.512099 5.724648
  [6,]  19.4343426 4.596760  1.9331009  7.260419 3.419566 5.773954
  [7,]  23.1212113 4.585824  1.9108795  7.260768 3.403642 5.768005
  [8,]  26.8080801 4.585565  2.0894028  7.081726 3.482396 5.688733
  [9,]  30.4949488 4.595983  2.4031959  6.788770 3.626889 5.565076
 [10,]  34.1818175 4.614751  2.5909733  6.638528 3.720350 5.509151
 [11,]  37.8686862 4.636179  2.5218657  6.750493 3.701767 5.570592
 [12,]  41.5555549 4.660009  2.3782280  6.941790 3.651585 5.668433
 [13,]  45.2424236 4.686241  2.2827935  7.089688 3.624047 5.748435
 [14,]  48.9292923 4.714874  2.2895666  7.140181 3.643019 5.786729
 [15,]  52.6161610 4.745909  2.4104608  7.081357 3.713767 5.778051
 [16,]  56.3030297 4.779345  2.6221003  6.936590 3.825959 5.732731
 [17,]  59.9898984 4.815183  2.8478882  6.782478 3.945745 5.684622
 [18,]  63.6767671 4.851505  2.9272096  6.775801 4.001070 5.701940
 [19,]  67.3636358 4.876803  2.8122204  6.941385 3.964369 5.789237
 [20,]  71.0505045 4.889159  2.6509578  7.127360 3.899995 5.878323
 [21,]  74.7373732 4.888573  2.5348518  7.242294 3.848355 5.928791
 [22,]  78.4242419 4.875045  2.5018107  7.248279 3.826203 5.923886
 [23,]  82.1111106 4.848575  2.5579364  7.139214 3.836236 5.860914
 [24,]  85.7979793 4.809163  2.6813642  6.936962 3.868791 5.749536
 [25,]  89.4848480 4.756810  2.8076239  6.705995 3.895375 5.618245
 [26,]  93.1717167 4.691653  2.8029494  6.580358 3.856948 5.526359
 [27,]  96.8585854 4.616763  2.5991190  6.634406 3.725073 5.508452
 [28,] 100.5454541 4.533392  2.3363526  6.730432 3.562419 5.504365
 [29,] 104.2323228 4.441542  2.1137639  6.769320 3.412790 5.470295
 [30,] 107.9191916 4.341212  1.9741507  6.708274 3.295099 5.387326
 [31,] 111.6060603 4.232403  1.9276268  6.537179 3.213816 5.250990
 [32,] 115.2929290 4.115114  1.9583478  6.271880 3.161940 5.068288
 [33,] 118.9797977 3.989345  2.0139194  5.964771 3.116314 4.862377
 [34,] 122.6666664 3.855097  1.9792742  5.730920 3.026084 4.684109
 [35,] 126.3535351 3.723354  1.7502391  5.696469 2.851344 4.595365
 [36,] 130.0404038 3.605102  1.4514108  5.758793 2.653286 4.556917
 [37,] 133.7272725 3.500340  1.1981842  5.802496 2.482911 4.517769
 [38,] 137.4141412 3.409069  1.0434284  5.774710 2.363583 4.454555
 [39,] 141.1010099 3.331289  1.0034773  5.659100 2.302521 4.360056
 [40,] 144.7878786 3.266999  1.0689431  5.465054 2.295577 4.238421
 [41,] 148.4747473 3.216199  1.1983987  5.234000 2.324440 4.107959
 [42,] 152.1616160 3.178891  1.2950618  5.062720 2.346340 4.011442
 [43,] 155.8484847 3.153770  1.2182646  5.089276 2.298381 4.009159
 [44,] 159.5353534 3.137655  1.0286130  5.246696 2.205572 4.069737
 [45,] 163.2222221 3.130399  0.8583771  5.402421 2.126288 4.134510
 [46,] 166.9090908 3.132003  0.7730450  5.490962 2.089471 4.174536
 [47,] 170.5959595 3.142468  0.7962383  5.488697 2.105561 4.179375
 [48,] 174.2828282 3.161792  0.9248633  5.398721 2.173190 4.150394
 [49,] 177.9696969 3.189977  1.1270149  5.252939 2.278259 4.101695
 [50,] 181.6565656 3.227021  1.3225172  5.131526 2.385333 4.068710
 [51,] 185.3434344 3.270132  1.3656241  5.174641 2.428442 4.111822
 [52,] 189.0303031 3.302546  1.2395748  5.365518 2.390824 4.214269
 [53,] 192.7171718 3.321470  1.0845270  5.558413 2.332862 4.310078
 [54,] 196.4040405 3.326903  0.9806553  5.673150 2.289988 4.363818
 [55,] 200.0909092 3.318845  0.9598637  5.677826 2.276302 4.361388
 [56,] 203.7777779 3.297297  1.0252446  5.569349 2.293172 4.301421
 [57,] 207.4646466 3.262258  1.1531752  5.371340 2.330157 4.194358
 [58,] 211.1515153 3.213728  1.2781672  5.149289 2.358315 4.069142
 [59,] 214.8383840 3.152551  1.2686530  5.036449 2.319970 3.985133
 [60,] 218.5252527 3.097276  1.0794134  5.115139 2.205490 3.989063
 [61,] 222.2121214 3.055492  0.8574064  5.253578 2.084057 4.026928
 [62,] 225.8989901 3.027199  0.6994066  5.354990 1.998440 4.055957
 [63,] 229.5858588 3.012396  0.6468321  5.377959 1.966944 4.057847
 [64,] 233.2727275 3.011083  0.7090563  5.313110 1.993711 4.028455
 [65,] 236.9595962 3.023261  0.8697169  5.176806 2.071511 3.975012
 [66,] 240.6464649 3.048930  1.0758874  5.021973 2.176952 3.920908
 [67,] 244.3333336 3.088089  1.2120845  4.964094 2.258996 3.917182
 [68,] 248.0202023 3.133659  1.1577169  5.109601 2.260399 4.006919
 [69,] 251.7070710 3.178559  1.0210949  5.336023 2.225076 4.132042
 [70,] 255.3939397 3.222789  0.9173020  5.528276 2.203888 4.241690
 [71,] 259.0808084 3.266349  0.8986940  5.634005 2.219973 4.312725
 [72,] 262.7676772 3.309240  0.9810599  5.637420 2.280310 4.338170
 [73,] 266.4545459 3.351460  1.1541921  5.548729 2.380386 4.322535
 [74,] 270.1414146 3.393011  1.3751066  5.410916 2.501206 4.284816
 [75,] 273.8282833 3.433892  1.5443567  5.323428 2.598819 4.268965
 [76,] 277.5151520 3.477646  1.5265177  5.428775 2.615353 4.339940
 [77,] 281.2020207 3.532933  1.4025453  5.663321 2.591417 4.474450
 [78,] 284.8888894 3.600147  1.3069802  5.893314 2.586691 4.613603
 [79,] 288.5757581 3.679288  1.3041714  6.054404 2.629614 4.728961
 [80,] 292.2626268 3.770355  1.4157372  6.124973 2.729741 4.810970
 [81,] 295.9494955 3.873350  1.6351279  6.111571 2.884176 4.862523
 [82,] 299.6363642 3.988271  1.9235246  6.053017 3.075764 4.900777
 [83,] 303.3232329 4.115119  2.1878128  6.042425 3.263353 4.966884
 [84,] 307.0101016 4.250931  2.2741947  6.227667 3.377320 5.124541
 [85,] 310.6969703 4.377931  2.2068258  6.549036 3.418420 5.337442
 [86,] 314.3838390 4.493157  2.1435872  6.842727 3.454774 5.531540
 [87,] 318.0707077 4.596608  2.1604234  7.032793 3.519946 5.673271
 [88,] 321.7575764 4.688285  2.2792960  7.097275 3.623642 5.752929
 [89,] 325.4444451 4.768188  2.4856564  7.050720 3.759432 5.776944
 [90,] 329.1313138 4.836316  2.7200135  6.952619 3.901025 5.771608
 [91,] 332.8181825 4.892670  2.8501306  6.935210 3.989978 5.795362
 [92,] 336.5050512 4.937196  2.6892635  7.185128 3.943731 5.930661
 [93,] 340.1919199 4.968714  2.3990817  7.538346 3.833075 6.104352
 [94,] 343.8787887 4.986741  2.2526600  7.720822 3.778425 6.195057
 [95,] 347.5656574 4.991277  2.3033257  7.679229 3.803348 6.179207
 [96,] 351.2525261 4.982324  2.4796805  7.484967 3.876290 6.088357
 [97,] 354.9393948 4.959879  2.5400849  7.379673 3.890460 6.029298
 [98,] 358.6262635 4.923944  2.0739157  7.773972 3.664385 6.183503
 [99,] 362.3131322 4.874518  0.8693635  8.879673 3.104456 6.644580
[100,] 366.0000009 4.811602 -0.9713665 10.594570 2.255841 7.367362
> 
> par(mfrow = c(1,2))
> plot(day,speed, pch = 3, cex=0.6,  xlab = "DAYS", ylab = "SPEED (knots)")
> lines(pc.5, lwd = 2.5, col = 2)
> lines(pc.9, lwd = 1.5, col = 3)
> lines(pc.1, lwd = 1.5, col = 3)
> plot(day,speed,type = "n",xlab = "DAYS", ylab = "SPEED (knots)")
> lines(pc.5, lwd = 1.5)
> lines(pc.9, col = 3)
> lines(pc.1, col = 3)
> abline(v = co.o5$knots, lty = 3, col = "gray70")
> ## rather rug(co.o5$knots, lty = 2)
> 

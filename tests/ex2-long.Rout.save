
R version 2.13.0 Patched (2011-04-24 r55634)
Copyright (C) 2011 The R Foundation for Statistical Computing
ISBN 3-900051-07-0
Platform: i686-pc-linux-gnu (32-bit)

R is free software and comes with ABSOLUTELY NO WARRANTY.
You are welcome to redistribute it under certain conditions.
Type 'license()' or 'licence()' for distribution details.

R is a collaborative project with many contributors.
Type 'contributors()' for more information and
'citation()' on how to cite R or R packages in publications.

Type 'demo()' for some demos, 'help()' for on-line help, or
'help.start()' for an HTML browser interface to help.
Type 'q()' to quit R.

> ####
> suppressMessages(library(cobs))
> 
> options(digits = 5)
> if(!dev.interactive(orNone=TRUE)) pdf("ex2.pdf")
> 
> source(system.file("util.R", package = "cobs"))
> 
> set.seed(821)
> x <- round(sort(rnorm(200)), 3) # rounding -> multiple values
> sum(duplicated(x)) # 9
[1] 3
> y <- (fx <- exp(-x)) + rt(200,4)/4
> summaryCobs(cxy  <- cobs(x,y, "decrease"))
qbsks2():
 Performing general knot selection ...

 Deleting unnecessary knots ...
List of 24
 $ call         : language cobs(x = x, y = y, constraint = "decrease")
 $ tau          : num 0.5
 $ degree       : num 2
 $ constraint   : chr "decrease"
 $ ic           : chr "AIC"
 $ pointwise    : NULL
 $ select.knots : logi TRUE
 $ select.lambda: logi FALSE
 $ x            : num [1:200] -2.56 -2.14 -1.91 -1.81 -1.78 ...
 $ y            : num [1:200] 12.7 8.24 6.67 5.88 6.42 ...
 $ resid        : num [1:200] 0.72 -0.149 0 -0.195 0.545 ...
 $ fitted       : num [1:200] 11.98 8.39 6.67 6.07 5.87 ...
 $ coef         : num [1:5] 11.9769 3.5917 1.0544 0.0295 0.0295
 $ knots        : num [1:4] -2.557 -0.813 0.418 2.573
 $ k0           : num 5
 $ k            : num 5
 $ x.ps         :Formal class 'matrix.csr' [package "SparseM"] with 4 slots
 $ SSy          : num 488
 $ lambda       : num 0
 $ icyc         : int 11
 $ ifl          : int 1
 $ pp.lambda    : NULL
 $ pp.sic       : NULL
 $ i.mask       : NULL
         cb.lo      ci.lo       fit    ci.up    cb.up
1   11.4448128 11.6875576 11.976923 12.26629 12.50903
2   10.9843366 11.2126114 11.484728 11.75684 11.98512
3   10.5344633 10.7489871 11.004712 11.26044 11.47496
4   10.0951784 10.2966768 10.536874 10.77707 10.97857
5    9.6664684  9.8556730 10.081215 10.30676 10.49596
6    9.2483213  9.4259693  9.637736  9.84950 10.02715
7    8.8407282  9.0075609  9.206435  9.40531  9.57214
8    8.4436848  8.6004453  8.787313  8.97418  9.13094
9    8.0571928  8.2046236  8.380369  8.55612  8.70355
10   7.6812627  7.8201015  7.985605  8.15111  8.28995
11   7.3159159  7.4468904  7.603020  7.75915  7.89012
12   6.9611870  7.0850095  7.232613  7.38022  7.50404
13   6.6171269  6.7344861  6.874385  7.01428  7.13164
14   6.2838041  6.3953578  6.528336  6.66131  6.77287
15   5.9613061  6.0676719  6.194466  6.32126  6.42763
16   5.6497392  5.7514863  5.872775  5.99406  6.09581
17   5.3492272  5.4468683  5.563262  5.67966  5.77730
18   5.0599086  5.1538933  5.265928  5.37796  5.47195
19   4.7819325  4.8726424  4.980774  5.08891  5.17961
20   4.5154542  4.6031999  4.707798  4.81240  4.90014
21   4.2606295  4.3456507  4.447001  4.54835  4.63337
22   4.0176099  4.1000771  4.198383  4.29669  4.37916
23   3.7865383  3.8665567  3.961943  4.05733  4.13735
24   3.5675443  3.6451602  3.737683  3.83021  3.90782
25   3.3607413  3.4359491  3.525601  3.61525  3.69046
26   3.1662231  3.2389744  3.325698  3.41242  3.48517
27   2.9840608  3.0542750  3.137974  3.22167  3.29189
28   2.8142997  2.8818753  2.962429  3.04298  3.11056
29   2.6569546  2.7217833  2.799063  2.87634  2.94117
30   2.5120031  2.5739870  2.647875  2.72176  2.78375
31   2.3793776  2.4384496  2.508867  2.57928  2.63836
32   2.2589520  2.3151025  2.382037  2.44897  2.50512
33   2.1505256  2.2038366  2.267386  2.33094  2.38425
34   2.0538038  2.1044916  2.164914  2.22534  2.27602
35   1.9677723  2.0162522  2.074043  2.13183  2.18031
36   1.8846710  1.9316617  1.987677  2.04369  2.09068
37   1.8024456  1.8486425  1.903712  1.95878  2.00498
38   1.7213655  1.7673410  1.822146  1.87695  1.92293
39   1.6417290  1.6879196  1.742982  1.79804  1.84423
40   1.5638322  1.6105393  1.666217  1.72189  1.76860
41   1.4879462  1.5353474  1.591852  1.64836  1.69576
42   1.4143040  1.4624707  1.519888  1.57731  1.62547
43   1.3430975  1.3920136  1.450324  1.50864  1.55755
44   1.2744792  1.3240589  1.383161  1.44226  1.49184
45   1.2085658  1.2586702  1.318397  1.37812  1.42823
46   1.1454438  1.1958944  1.256034  1.31617  1.36662
47   1.0851730  1.1357641  1.196072  1.25638  1.30697
48   1.0277900  1.0782992  1.138509  1.19872  1.24923
49   0.9733099  1.0235079  1.083347  1.14319  1.19338
50   0.9217268  0.9713870  1.030585  1.08978  1.13944
51   0.8730129  0.9219214  0.980223  1.03852  1.08743
52   0.8271160  0.8750827  0.932262  0.98944  1.03741
53   0.7839554  0.8308269  0.886700  0.94257  0.98945
54   0.7434158  0.7890916  0.843540  0.89799  0.94366
55   0.7053406  0.7497913  0.802779  0.85577  0.90022
56   0.6695233  0.7128138  0.764419  0.81602  0.85931
57   0.6357022  0.6780170  0.728459  0.77890  0.82121
58   0.6035616  0.6452289  0.694899  0.74457  0.78624
59   0.5724566  0.6139693  0.663455  0.71294  0.75445
60   0.5410437  0.5829503  0.632905  0.68286  0.72477
61   0.5094333  0.5521679  0.603110  0.65405  0.69679
62   0.4778879  0.5217649  0.574069  0.62637  0.67025
63   0.4466418  0.4918689  0.545782  0.59970  0.64492
64   0.4158910  0.4625864  0.518250  0.57391  0.62061
65   0.3857918  0.4340022  0.491472  0.54894  0.59715
66   0.3564634  0.4061813  0.465448  0.52471  0.57443
67   0.3279928  0.3791711  0.440179  0.50119  0.55236
68   0.3004403  0.3530042  0.415663  0.47832  0.53089
69   0.2738429  0.3277009  0.391903  0.45610  0.50996
70   0.2482184  0.3032707  0.368896  0.43452  0.48957
71   0.2235676  0.2797141  0.346644  0.41357  0.46972
72   0.1998762  0.2570233  0.325146  0.39327  0.45042
73   0.1771158  0.2351830  0.304402  0.37362  0.43169
74   0.1552452  0.2141706  0.284413  0.35466  0.41358
75   0.1342101  0.1939567  0.265178  0.33640  0.39615
76   0.1139444  0.1745054  0.246697  0.31889  0.37945
77   0.0943704  0.1557743  0.228971  0.30217  0.36357
78   0.0753996  0.1377153  0.211999  0.28628  0.34860
79   0.0569347  0.1202755  0.195781  0.27129  0.33463
80   0.0388708  0.1033980  0.180318  0.25724  0.32177
81   0.0210989  0.0870233  0.165609  0.24419  0.31012
82   0.0035089  0.0710917  0.151654  0.23222  0.29980
83  -0.0140062  0.0555449  0.138454  0.22136  0.29091
84  -0.0315470  0.0403283  0.126008  0.21169  0.28356
85  -0.0492034  0.0253928  0.114316  0.20324  0.27783
86  -0.0670524  0.0106968  0.103378  0.19606  0.27381
87  -0.0851561 -0.0037936  0.093195  0.19018  0.27155
88  -0.1035613 -0.0181039  0.083766  0.18564  0.27109
89  -0.1223000 -0.0322515  0.075091  0.18243  0.27248
90  -0.1413914 -0.0462467  0.067171  0.18059  0.27573
91  -0.1608432 -0.0600938  0.060005  0.18010  0.28085
92  -0.1806546 -0.0737923  0.053594  0.18098  0.28784
93  -0.2008180 -0.0873382  0.047936  0.18321  0.29669
94  -0.2213213 -0.1007247  0.043033  0.18679  0.30739
95  -0.2421494 -0.1139438  0.038884  0.19171  0.31992
96  -0.2632855 -0.1269863  0.035490  0.19797  0.33427
97  -0.2847123 -0.1398427  0.032850  0.20554  0.35041
98  -0.3064126 -0.1525038  0.030964  0.21443  0.36834
99  -0.3283696 -0.1649603  0.029833  0.22463  0.38804
100 -0.3505674 -0.1772037  0.029456  0.23611  0.40948
knots :
[1] -2.557 -0.813  0.418  2.573
coef  :
[1] 11.976924  3.591747  1.054378  0.029456  0.029456
> 1 - sum(cxy $ resid ^ 2) / sum((y - mean(y))^2) # R^2 = 97.6%
[1] 0.95969
> 
> ## Interpolation
> cpuTime(cxyI  <- cobs(x,y, "decrease", knots = unique(x)))
qbsks2():
 Performing general knot selection ...

 Deleting unnecessary knots ...
Time elapsed: 7.542 
Warning message:
In cobs(x, y, "decrease", knots = unique(x)) :
  The number of knots can't be equal to the number of unique x for degree = 2.
'cobs' has automatically deleted the middle knot.
> ## takes quite long : 63 sec. (Pent. III, 700 MHz) --- this is because
> ## each knot is added sequentially...  {{improve!}}
> summaryCobs(cxyI)# only 7 knots remaining!
List of 24
 $ call         : language cobs(x = x, y = y, constraint = "decrease", knots = unique(x))
 $ tau          : num 0.5
 $ degree       : num 2
 $ constraint   : chr "decrease"
 $ ic           : chr "AIC"
 $ pointwise    : NULL
 $ select.knots : logi TRUE
 $ select.lambda: logi FALSE
 $ x            : num [1:200] -2.56 -2.14 -1.91 -1.81 -1.78 ...
 $ y            : num [1:200] 12.7 8.24 6.67 5.88 6.42 ...
 $ resid        : num [1:200] 1.0033 -0.0707 0 -0.2172 0.5157 ...
 $ fitted       : num [1:200] 11.69 8.31 6.67 6.09 5.9 ...
 $ coef         : num [1:5] 11.694 3.208 0.806 0.047 0.047
 $ knots        : num [1:4] -2.557 -0.674 0.759 2.573
 $ k0           : num 5
 $ k            : num 5
 $ x.ps         :Formal class 'matrix.csr' [package "SparseM"] with 4 slots
 $ SSy          : num 488
 $ lambda       : num 0
 $ icyc         : int 13
 $ ifl          : int 1
 $ pp.lambda    : NULL
 $ pp.sic       : NULL
 $ i.mask       : NULL
         cb.lo      ci.lo       fit    ci.up    cb.up
1   11.1538911 11.4001275 11.693655 11.98718 12.23342
2   10.7233627 10.9554200 11.232045 11.50867 11.74073
3   10.3022748 10.5207664 10.781221 11.04168 11.26017
4    9.8906140 10.0961593 10.341181 10.58620 10.79175
5    9.4883663  9.6815911  9.911926 10.14226 10.33549
6    9.0955175  9.2770541  9.493456  9.70986  9.89139
7    8.7120540  8.8825408  9.085771  9.28900  9.45949
8    8.3379626  8.4980442  8.688870  8.87970  9.03978
9    7.9732324  8.1235582  8.302755  8.48195  8.63228
10   7.6178554  7.7590786  7.927425  8.09577  8.23699
11   7.2718280  7.4046034  7.562879  7.72115  7.85393
12   6.9351531  7.0601341  7.209118  7.35810  7.48308
13   6.6078422  6.7256770  6.866143  7.00661  7.12444
14   6.2899172  6.4012440  6.533952  6.66666  6.77799
15   5.9814135  6.0868544  6.212546  6.33824  6.44368
16   5.6823816  5.7825356  5.901925  6.02131  6.12147
17   5.3928884  5.4883241  5.602089  5.71585  5.81129
18   5.1130182  5.2042656  5.313038  5.42181  5.51306
19   4.8428719  4.9304150  5.034771  5.13913  5.22667
20   4.5825649  4.6668351  4.767290  4.86774  4.95201
21   4.3322242  4.4135949  4.510593  4.60759  4.68896
22   4.0919845  4.1707677  4.264682  4.35860  4.43738
23   3.8619831  3.9384282  4.029555  4.12068  4.19713
24   3.6423558  3.7166502  3.805213  3.89378  3.96807
25   3.4332323  3.5055042  3.591656  3.67781  3.75008
26   3.2347321  3.3050552  3.388884  3.47271  3.54304
27   3.0469615  3.1153611  3.196897  3.27843  3.34683
28   2.8700109  2.9364710  3.015695  3.09492  3.16138
29   2.7039519  2.7684238  2.845278  2.92213  2.98660
30   2.5488350  2.6112469  2.685645  2.76004  2.82246
31   2.4046866  2.4649549  2.536798  2.60864  2.66891
32   2.2715049  2.3295465  2.398735  2.46792  2.52597
33   2.1492545  2.2050028  2.271458  2.33791  2.39366
34   2.0378591  2.0912820  2.154965  2.21865  2.27207
35   1.9371915  1.9883151  2.049257  2.11020  2.16132
36   1.8470619  1.8959987  1.954334  2.01267  2.06161
37   1.7672057  1.8141892  1.870196  1.92620  1.97319
38   1.6952474  1.7407021  1.794887  1.84907  1.89453
39   1.6243302  1.6688544  1.721930  1.77500  1.81953
40   1.5541038  1.5982215  1.650812  1.70340  1.74752
41   1.4847912  1.5289248  1.581535  1.63414  1.67828
42   1.4166246  1.4610906  1.514097  1.56710  1.61157
43   1.3498260  1.3948395  1.448498  1.50216  1.54717
44   1.2845947  1.3302801  1.384740  1.43920  1.48488
45   1.2211012  1.2675048  1.322821  1.37814  1.42454
46   1.1594856  1.2065901  1.262741  1.31889  1.36600
47   1.0998598  1.1475966  1.204502  1.26141  1.30914
48   1.0423098  1.0905713  1.148102  1.20563  1.25389
49   0.9868993  1.0355487  1.093541  1.15153  1.20018
50   0.9336722  0.9825526  1.040821  1.09909  1.14797
51   0.8826547  0.9315974  0.989940  1.04828  1.09722
52   0.8338566  0.8826884  0.940899  0.99911  1.04794
53   0.7872717  0.8358221  0.893697  0.95157  1.00012
54   0.7428773  0.7909864  0.848335  0.90568  0.95379
55   0.7006333  0.7481592  0.804813  0.86147  0.90899
56   0.6604797  0.7073081  0.763130  0.81895  0.86578
57   0.6223339  0.6683881  0.723287  0.77819  0.82424
58   0.5860875  0.6313403  0.685284  0.73923  0.78448
59   0.5516026  0.5960896  0.649121  0.70215  0.74664
60   0.5187096  0.5625439  0.614797  0.66705  0.71088
61   0.4872077  0.5305938  0.582313  0.63403  0.67742
62   0.4568700  0.5001161  0.551668  0.60322  0.64647
63   0.4274560  0.4709801  0.522863  0.57475  0.61827
64   0.3987313  0.4430581  0.495898  0.54874  0.59306
65   0.3704914  0.4162389  0.470772  0.52531  0.57105
66   0.3423556  0.3900501  0.446905  0.50376  0.55145
67   0.3143257  0.3642345  0.423729  0.48322  0.53313
68   0.2867269  0.3389689  0.401244  0.46352  0.51576
69   0.2598010  0.3143849  0.379452  0.44452  0.49910
70   0.2337204  0.2905762  0.358352  0.42613  0.48298
71   0.2086023  0.2676065  0.337943  0.40828  0.46728
72   0.1845205  0.2455159  0.318226  0.39094  0.45193
73   0.1615142  0.2243258  0.299201  0.37408  0.43689
74   0.1395945  0.2040422  0.280868  0.35769  0.42214
75   0.1187486  0.1846581  0.263226  0.34179  0.40770
76   0.0989422  0.1661550  0.246276  0.32640  0.39361
77   0.0801212  0.1485033  0.230019  0.31153  0.37992
78   0.0622123  0.1316632  0.214453  0.29724  0.36669
79   0.0451234  0.1155847  0.199578  0.28357  0.35403
80   0.0287442  0.1002077  0.185396  0.27058  0.34205
81   0.0129468  0.0854626  0.171906  0.25835  0.33086
82  -0.0024125  0.0712715  0.159107  0.24694  0.32063
83  -0.0174905  0.0575489  0.147000  0.23645  0.31149
84  -0.0324528  0.0442048  0.135585  0.22697  0.30362
85  -0.0474685  0.0311473  0.124862  0.21858  0.29719
86  -0.0627034  0.0182862  0.114830  0.21137  0.29236
87  -0.0783130  0.0055369  0.105491  0.20544  0.28929
88  -0.0944357 -0.0071758  0.096843  0.20086  0.28812
89  -0.1111881 -0.0199153  0.088887  0.19769  0.28896
90  -0.1286614 -0.0327312  0.081623  0.19598  0.29191
91  -0.1469213 -0.0456593  0.075051  0.19576  0.29702
92  -0.1660093 -0.0587222  0.069170  0.19706  0.30435
93  -0.1859461 -0.0719310  0.063981  0.19989  0.31391
94  -0.2067351 -0.0852876  0.059485  0.20426  0.32570
95  -0.2283675 -0.0987873  0.055680  0.21015  0.33973
96  -0.2508253 -0.1124202  0.052566  0.21755  0.35596
97  -0.2740849 -0.1261736  0.050145  0.22646  0.37437
98  -0.2981198 -0.1400330  0.048415  0.23686  0.39495
99  -0.3229025 -0.1539834  0.047378  0.24874  0.41766
100 -0.3484056 -0.1680099  0.047032  0.26207  0.44247
knots :
[1] -2.557 -0.674  0.759  2.573
coef  :
[1] 11.693656  3.208548  0.805818  0.047032  0.047032
> 
> summaryCobs(cxy1  <- cobs(x,y, "decrease", lambda = 0.1))
List of 24
 $ call         : language cobs(x = x, y = y, constraint = "decrease", lambda = 0.1)
 $ tau          : num 0.5
 $ degree       : num 2
 $ constraint   : chr "decrease"
 $ ic           : NULL
 $ pointwise    : NULL
 $ select.knots : logi TRUE
 $ select.lambda: logi FALSE
 $ x            : num [1:200] -2.56 -2.14 -1.91 -1.81 -1.78 ...
 $ y            : num [1:200] 12.7 8.24 6.67 5.88 6.42 ...
 $ resid        : num [1:200] 0 -0.315 0 -0.161 0.586 ...
 $ fitted       : num [1:200] 12.7 8.56 6.67 6.04 5.83 ...
 $ coef         : num [1:22] 12.7 5.78 3.16 2.43 2.11 ...
 $ knots        : num [1:20] -2.557 -1.34 -1.03 -0.901 -0.772 ...
 $ k0           : int 15
 $ k            : int 15
 $ x.ps         :Formal class 'matrix.csr' [package "SparseM"] with 4 slots
 $ SSy          : num 488
 $ lambda       : num 0.1
 $ icyc         : int 23
 $ ifl          : int 1
 $ pp.lambda    : NULL
 $ pp.sic       : NULL
 $ i.mask       : NULL
         cb.lo      ci.lo        fit    ci.up    cb.up
1   12.0912847 12.4849933 12.6970034 12.90901 13.30272
2   11.5452819 11.9166521 12.1166331 12.31661 12.68798
3   11.0146966 11.3650966 11.5537853 11.74247 12.09287
4   10.4995535 10.8303355 11.0084599 11.18658 11.51737
5    9.9998870 10.3123808 10.4806571 10.64893 10.96143
6    9.5157430  9.8112485  9.9703768 10.12951 10.42501
7    9.0471805  9.3269594  9.4776191  9.62828  9.90806
8    8.5942728  8.8595392  9.0023838  9.14523  9.41049
9    8.1571088  8.4090188  8.5446710  8.68032  8.93223
10   7.7357927  7.9754347  8.1044808  8.23353  8.47317
11   7.3304438  7.5588289  7.6818131  7.80480  8.03318
12   6.9411951  7.1592477  7.2766679  7.39409  7.61214
13   6.5681906  6.7767415  6.8890452  7.00135  7.20990
14   6.2115819  6.4113636  6.5189450  6.62653  6.82631
15   5.8715240  6.0631680  6.1663674  6.26957  6.46121
16   5.5481704  5.7322086  5.8313123  5.93042  6.11445
17   5.2416676  5.4185366  5.5137796  5.60902  5.78589
18   4.9521494  5.1221988  5.2137695  5.30534  5.47539
19   4.6797308  4.8432355  4.9312819  5.01933  5.18283
20   4.4245017  4.5816781  4.6663169  4.75096  4.90813
21   4.1865199  4.3375470  4.4188743  4.50020  4.65123
22   3.9658032  4.1108482  4.1889542  4.26706  4.41211
23   3.7623206  3.9015710  3.9765567  4.05154  4.19079
24   3.5759813  3.7096836  3.7816817  3.85368  3.98738
25   3.4043771  3.5329043  3.6021155  3.67133  3.79985
26   3.2347309  3.3585931  3.4252922  3.49199  3.61585
27   3.0652721  3.1848437  3.2492325  3.31362  3.43319
28   2.8962030  3.0117271  3.0739363  3.13615  3.25167
29   2.7276530  2.8392885  2.8994037  2.95952  3.07115
30   2.5596612  2.6675415  2.7256346  2.78373  2.89161
31   2.3944947  2.4988186  2.5549966  2.61117  2.71550
32   2.2444821  2.3455939  2.4000421  2.45449  2.55560
33   2.1114672  2.2097080  2.2626102  2.31551  2.41375
34   1.9954176  2.0911496  2.1427009  2.19425  2.28998
35   1.8963846  1.9899366  2.0403140  2.09069  2.18424
36   1.8125024  1.9041996  1.9535781  2.00296  2.09465
37   1.7347658  1.8248332  1.8733340  1.92183  2.01190
38   1.6620975  1.7506630  1.7983550  1.84605  1.93461
39   1.5945123  1.6816941  1.7286411  1.77559  1.86277
40   1.5278221  1.6138190  1.6601279  1.70644  1.79243
41   1.4573347  1.5423451  1.5881227  1.63390  1.71891
42   1.3839943  1.4682138  1.5135655  1.55892  1.64314
43   1.3227219  1.4063482  1.4513806  1.49641  1.58004
44   1.2787473  1.3619265  1.4067181  1.45151  1.53469
45   1.2488624  1.3317463  1.3763789  1.42101  1.50390
46   1.2168724  1.2994789  1.3439621  1.38845  1.47105
47   1.1806389  1.2628708  1.3071522  1.35143  1.43367
48   1.1401892  1.2219316  1.2659495  1.30997  1.39171
49   1.0941843  1.1754044  1.2191410  1.26288  1.34410
50   1.0326549  1.1134412  1.1569442  1.20045  1.28123
51   0.9535058  1.0339215  1.0772249  1.12053  1.20094
52   0.8632281  0.9433870  0.9865521  1.02972  1.10988
53   0.7875624  0.8676441  0.9107678  0.95389  1.03397
54   0.7267897  0.8069673  0.8501425  0.89332  0.97350
55   0.6673925  0.7477244  0.7909827  0.83424  0.91457
56   0.6072642  0.6877460  0.7310850  0.77442  0.85491
57   0.5471548  0.6278279  0.6712700  0.71471  0.79539
58   0.4995140  0.5804770  0.6240752  0.66767  0.74864
59   0.4686435  0.5499607  0.5937495  0.63754  0.71886
60   0.4531016  0.5348803  0.5789177  0.62296  0.70473
61   0.4381911  0.5206110  0.5649937  0.60938  0.69180
62   0.4199957  0.5032331  0.5480561  0.59288  0.67612
63   0.4036491  0.4879280  0.5333117  0.57870  0.66297
64   0.3952493  0.4807890  0.5268517  0.57291  0.65845
65   0.3926229  0.4796600  0.5265291  0.57340  0.66044
66   0.3900185  0.4787485  0.5265291  0.57431  0.66304
67   0.3870480  0.4776752  0.5264774  0.57528  0.66591
68   0.3738545  0.4665585  0.5164792  0.56640  0.65910
69   0.3432056  0.4380737  0.4891596  0.54025  0.63511
70   0.2950830  0.3922142  0.4445189  0.49682  0.59395
71   0.2295290  0.3291123  0.3827373  0.43636  0.53595
72   0.1670195  0.2693294  0.3244228  0.37952  0.48183
73   0.1216565  0.2269375  0.2836308  0.34032  0.44561
74   0.0934100  0.2019260  0.2603613  0.31880  0.42731
75   0.0787462  0.1907702  0.2510947  0.31142  0.42344
76   0.0658428  0.1813823  0.2435998  0.30582  0.42136
77   0.0538230  0.1727768  0.2368329  0.30089  0.41984
78   0.0427388  0.1649719  0.2307938  0.29662  0.41885
79   0.0325663  0.1579592  0.2254827  0.29301  0.41840
80   0.0232151  0.1517072  0.2208995  0.29009  0.41858
81   0.0145359  0.1461634  0.2170442  0.28792  0.41955
82   0.0063272  0.1412575  0.2139168  0.28658  0.42151
83  -0.0016568  0.1369034  0.2115173  0.28613  0.42469
84  -0.0096967  0.1330028  0.2098457  0.28669  0.42939
85  -0.0180957  0.1294496  0.2089021  0.28835  0.43590
86  -0.0272134  0.1260791  0.2086264  0.29117  0.44447
87  -0.0387972  0.1210358  0.2071052  0.29317  0.45301
88  -0.0534279  0.1135207  0.2034217  0.29332  0.46027
89  -0.0709531  0.1035871  0.1975762  0.29157  0.46611
90  -0.0912981  0.0912612  0.1895684  0.28788  0.47043
91  -0.1144525  0.0765465  0.1793985  0.28225  0.47325
92  -0.1404576  0.0594287  0.1670665  0.27470  0.47459
93  -0.1693951  0.0398791  0.1525723  0.26527  0.47454
94  -0.2013769  0.0178586  0.1359159  0.25397  0.47321
95  -0.2365365 -0.0066795  0.1170974  0.24087  0.47073
96  -0.2750210 -0.0337868  0.0961167  0.22602  0.46725
97  -0.3169840 -0.0635170  0.0729738  0.20946  0.46293
98  -0.3625797 -0.0959240  0.0476688  0.19126  0.45792
99  -0.4119579 -0.1310604  0.0202016  0.17146  0.45236
100 -0.4652595 -0.1689754 -0.0094278  0.15012  0.44640
knots :
 [1] -2.557 -1.340 -1.030 -0.901 -0.772 -0.586 -0.448 -0.305 -0.092  0.054
[11]  0.163  0.329  0.481  0.606  0.722  0.859  1.065  1.244  1.837  2.573
coef  :
 [1] 12.6970048  5.7788265  3.1620633  2.4291174  2.1069607  1.8462166
 [7]  1.6371062  1.4304905  1.3348346  1.1758220  0.9413974  0.7863913
[13]  0.5998958  0.5697029  0.5265291  0.5265291  0.5265291  0.2707227
[19]  0.2086712  0.2086712 -0.0094278  6.5257497
> 1 - sum(cxy1 $ resid ^ 2) / sum((y - mean(y))^2) # R^2 = 98.2%
[1] 0.96169
> 
> summaryCobs(cxy2 <- cobs(x,y, "decrease", lambda = 1e-2))
List of 24
 $ call         : language cobs(x = x, y = y, constraint = "decrease", lambda = 0.01)
 $ tau          : num 0.5
 $ degree       : num 2
 $ constraint   : chr "decrease"
 $ ic           : NULL
 $ pointwise    : NULL
 $ select.knots : logi TRUE
 $ select.lambda: logi FALSE
 $ x            : num [1:200] -2.56 -2.14 -1.91 -1.81 -1.78 ...
 $ y            : num [1:200] 12.7 8.24 6.67 5.88 6.42 ...
 $ resid        : num [1:200] 0 -0.146 0.1468 -0.0463 0.6868 ...
 $ fitted       : num [1:200] 12.7 8.39 6.52 5.92 5.73 ...
 $ coef         : num [1:22] 12.7 5.34 3.59 2.19 2.13 ...
 $ knots        : num [1:20] -2.557 -1.34 -1.03 -0.901 -0.772 ...
 $ k0           : int 21
 $ k            : int 21
 $ x.ps         :Formal class 'matrix.csr' [package "SparseM"] with 4 slots
 $ SSy          : num 488
 $ lambda       : num 0.01
 $ icyc         : int 35
 $ ifl          : int 1
 $ pp.lambda    : NULL
 $ pp.sic       : NULL
 $ i.mask       : NULL
         cb.lo      ci.lo        fit    ci.up    cb.up
1   12.0477594 12.4997491 12.6970071 12.89427 13.34625
2   11.4687308 11.8950752 12.0811411 12.26721 12.69355
3   10.9090823 11.3113523 11.4869116 11.66247 12.06474
4   10.3688404 10.7485883 10.9143185 11.08005 11.45980
5    9.8480420 10.2067945 10.3633618 10.51993 10.87868
6    9.3467363  9.6859859  9.8340417  9.98210 10.32135
7    8.8649866  9.1861815  9.3263579  9.46653  9.78773
8    8.4028715  8.7074055  8.8403106  8.97322  9.27775
9    7.9604861  8.2496865  8.3758998  8.50211  8.79131
10   7.5379421  7.8130586  7.9331254  8.05319  8.32831
11   7.1353676  7.3975607  7.5119874  7.62641  7.88861
12   6.7529050  7.0032361  7.1124859  7.22174  7.47207
13   6.3907086  6.6301316  6.7346209  6.83911  7.07853
14   6.0489410  6.2782966  6.3783923  6.47849  6.70784
15   5.7277684  5.9477816  6.0438001  6.13982  6.35983
16   5.4273551  5.6386366  5.7308444  5.82305  6.03433
17   5.1478583  5.3509094  5.4395252  5.52814  5.73119
18   4.8894214  5.0846433  5.1698424  5.25504  5.45026
19   4.6521676  4.8398760  4.9217960  5.00372  5.19142
20   4.4361933  4.6166367  4.6953861  4.77414  4.95458
21   4.2415605  4.4149443  4.4906127  4.56628  4.73966
22   4.0682883  4.2348044  4.3074756  4.38015  4.54666
23   3.9163432  4.0762071  4.1459751  4.21574  4.37561
24   3.7856282  3.9391227  4.0061110  4.07310  4.22659
25   3.6683774  3.8159306  3.8803259  3.94472  4.09227
26   3.5214653  3.6636629  3.7257209  3.78778  3.92998
27   3.3383583  3.4756303  3.5355387  3.59545  3.73272
28   3.1192735  3.2518988  3.3097793  3.36766  3.50028
29   2.8643493  2.9925103  3.0484425  3.10437  3.23254
30   2.5736278  2.6974778  2.7515286  2.80558  2.92943
31   2.2696062  2.3893733  2.4416422  2.49391  2.61368
32   2.0718959  2.1879754  2.2386350  2.28929  2.40537
33   1.9979346  2.1107181  2.1599392  2.20916  2.32194
34   1.9710324  2.0809358  2.1288999  2.17686  2.28677
35   1.9261503  2.0335510  2.0804229  2.12729  2.23470
36   1.8645775  1.9698487  2.0157914  2.06173  2.16701
37   1.7927585  1.8961587  1.9412848  1.98641  2.08981
38   1.7116948  1.8133707  1.8577443  1.90212  2.00379
39   1.6214021  1.7214896  1.7651699  1.80885  1.90894
40   1.5242004  1.6229275  1.6660141  1.70910  1.80783
41   1.4229217  1.5205162  1.5631086  1.60570  1.70330
42   1.3194940  1.4161806  1.4583766  1.50057  1.59726
43   1.2442053  1.3402109  1.3821098  1.42401  1.52001
44   1.2075941  1.3030864  1.3447613  1.38644  1.48193
45   1.2023778  1.2975311  1.3390581  1.38059  1.47574
46   1.1914924  1.2863272  1.3277152  1.36910  1.46394
47   1.1698641  1.2642688  1.3054691  1.34667  1.44107
48   1.1375221  1.2313649  1.2723199  1.31327  1.40712
49   1.0934278  1.1866710  1.2273643  1.26806  1.36130
50   1.0300956  1.1228408  1.1633168  1.20379  1.29654
51   0.9459780  1.0382977  1.0785880  1.11888  1.21120
52   0.8492712  0.9412961  0.9814577  1.02162  1.11364
53   0.7724392  0.8643755  0.9044985  0.94462  1.03656
54   0.7154255  0.8074718  0.8476428  0.88781  0.97986
55   0.6587891  0.7510125  0.7912608  0.83151  0.92373
56   0.5994755  0.6918710  0.7321944  0.77252  0.86491
57   0.5383570  0.6309722  0.6713915  0.71181  0.80443
58   0.4898228  0.5827709  0.6233354  0.66390  0.75685
59   0.4588380  0.5521926  0.5929345  0.63368  0.72703
60   0.4438719  0.5377564  0.5787296  0.61970  0.71359
61   0.4293281  0.5239487  0.5652432  0.60654  0.70116
62   0.4110511  0.5066103  0.5483143  0.59002  0.68558
63   0.3944126  0.4911673  0.5333932  0.57562  0.67237
64   0.3857958  0.4839980  0.5268556  0.56971  0.66792
65   0.3830000  0.4829213  0.5265291  0.57014  0.67006
66   0.3802084  0.4820731  0.5265291  0.57099  0.67285
67   0.3770181  0.4810608  0.5264673  0.57187  0.67592
68   0.3616408  0.4680678  0.5145149  0.56096  0.66739
69   0.3254129  0.4343244  0.4818557  0.52939  0.63830
70   0.2683149  0.3798245  0.4284897  0.47715  0.58866
71   0.1904294  0.3047541  0.3546478  0.40454  0.51887
72   0.1179556  0.2354105  0.2866704  0.33793  0.45539
73   0.0689088  0.1897746  0.2425231  0.29527  0.41614
74   0.0432569  0.1678366  0.2222059  0.27658  0.40115
75   0.0359906  0.1645977  0.2207246  0.27685  0.40546
76   0.0301934  0.1628364  0.2207246  0.27861  0.41126
77   0.0245630  0.1611257  0.2207246  0.28032  0.41689
78   0.0191553  0.1594827  0.2207246  0.28197  0.42229
79   0.0139446  0.1578996  0.2207246  0.28355  0.42750
80   0.0088340  0.1563468  0.2207246  0.28510  0.43262
81   0.0036634  0.1547759  0.2207246  0.28667  0.43779
82  -0.0017830  0.1531211  0.2207246  0.28833  0.44323
83  -0.0077688  0.1513025  0.2207246  0.29015  0.44922
84  -0.0145948  0.1492286  0.2207246  0.29222  0.45604
85  -0.0225859  0.1468007  0.2207246  0.29465  0.46404
86  -0.0321107  0.1438739  0.2206774  0.29748  0.47347
87  -0.0445016  0.1389916  0.2190720  0.29915  0.48265
88  -0.0601227  0.1315395  0.2151851  0.29883  0.49049
89  -0.0788103  0.1215673  0.2090164  0.29647  0.49684
90  -0.1004844  0.1090993  0.2005661  0.29203  0.50162
91  -0.1251339  0.0941388  0.1898342  0.28553  0.50480
92  -0.1528032  0.0766725  0.1768206  0.27697  0.50644
93  -0.1835797  0.0566736  0.1615253  0.26638  0.50663
94  -0.2175834  0.0341058  0.1439484  0.25379  0.50548
95  -0.2549574  0.0089256  0.1240898  0.23925  0.50314
96  -0.2958592 -0.0189149  0.1019496  0.22281  0.49976
97  -0.3404537 -0.0494657  0.0775277  0.20452  0.49551
98  -0.3889062 -0.0827771  0.0508241  0.18443  0.49055
99  -0.4413769 -0.1188979  0.0218389  0.16258  0.48505
100 -0.4980173 -0.1578738 -0.0094279  0.13902  0.47916
knots :
 [1] -2.557 -1.340 -1.030 -0.901 -0.772 -0.586 -0.448 -0.305 -0.092  0.054
[11]  0.163  0.329  0.481  0.606  0.722  0.859  1.065  1.244  1.837  2.573
coef  :
 [1] 12.697009  5.337850  3.591398  2.187733  2.133993  1.936435  1.631856
 [8]  1.340650  1.340650  1.185401  0.931750  0.789326  0.598245  0.570221
[15]  0.526529  0.526529  0.526529  0.220725  0.220725  0.220725 -0.009428
[22] 46.342964
> 1 - sum(cxy2 $ resid ^ 2) / sum((y - mean(y))^2) # R^2 = 98.2% (tiny bit better)
[1] 0.96257
> 
> summaryCobs(cxy3 <- cobs(x,y, "decrease", lambda = 1e-6, nknots = 60))
List of 24
 $ call         : language cobs(x = x, y = y, constraint = "decrease", nknots = 60, lambda = 1e-06)
 $ tau          : num 0.5
 $ degree       : num 2
 $ constraint   : chr "decrease"
 $ ic           : NULL
 $ pointwise    : NULL
 $ select.knots : logi TRUE
 $ select.lambda: logi FALSE
 $ x            : num [1:200] -2.56 -2.14 -1.91 -1.81 -1.78 ...
 $ y            : num [1:200] 12.7 8.24 6.67 5.88 6.42 ...
 $ resid        : num [1:200] 0 0 0 -0.382 0.309 ...
 $ fitted       : num [1:200] 12.7 8.24 6.67 6.26 6.11 ...
 $ coef         : num [1:62] 12.7 7.69 6.09 4.35 3.73 3.73 2.74 2.57 2.57 2.25 ...
 $ knots        : num [1:60] -2.56 -1.81 -1.73 -1.38 -1.23 ...
 $ k0           : int 61
 $ k            : int 61
 $ x.ps         :Formal class 'matrix.csr' [package "SparseM"] with 4 slots
 $ SSy          : num 488
 $ lambda       : num 1e-06
 $ icyc         : int 46
 $ ifl          : int 1
 $ pp.lambda    : NULL
 $ pp.sic       : NULL
 $ i.mask       : NULL
         cb.lo       ci.lo        fit     ci.up    cb.up
1   12.0247124 12.56890432 12.6970139 12.825123 13.36932
2   11.3797843 11.89599414 12.0175164 12.139039 12.65525
3   10.7668218 11.25721357 11.3726579 11.488102 11.97849
4   10.1860204 10.65259986 10.7624385 10.872277 11.33886
5    9.6375946 10.08219388 10.1868581 10.291522 10.73612
6    9.1217734  9.54603927  9.6459167  9.745794 10.17006
7    8.6387946  9.04418136  9.1396144  9.235048  9.64043
8    8.1888978  8.57666578  8.6679512  8.759237  9.14700
9    7.7723156  8.14353686  8.2309270  8.318317  8.68954
10   7.3892646  7.74483589  7.8285418  7.912248  8.26782
11   7.0399352  7.38059913  7.4607957  7.540992  7.88166
12   6.7244802  7.05085572  7.1276886  7.204521  7.53090
13   6.4430029  6.75562533  6.8292205  6.902816  7.21544
14   6.1955428  6.49491547  6.5653915  6.635868  6.93524
15   5.9820595  6.26871848  6.3362016  6.403685  6.69034
16   5.7696526  6.04428975  6.1089428  6.173596  6.44823
17   5.4339991  5.69759119  5.7596440  5.821697  6.08529
18   5.0454361  5.29908138  5.3587927  5.418504  5.67215
19   4.6993977  4.94405130  5.0016458  5.059240  5.30389
20   4.3963458  4.63268699  4.6883247  4.743962  4.98030
21   4.1365583  4.36504142  4.4188292  4.472617  4.70110
22   3.9202312  4.14115193  4.1931594  4.245167  4.46609
23   3.7474595  3.96103662  4.0113153  4.061594  4.27517
24   3.6182953  3.82478434  3.8733944  3.922005  4.12849
25   3.5335861  3.73343196  3.7804782  3.827524  4.02737
26   3.4937186  3.68729597  3.7328665  3.778437  3.97201
27   3.4752667  3.66292175  3.7070981  3.751274  3.93893
28   3.3043525  3.48641351  3.5292729  3.572132  3.75419
29   2.9458452  3.12249549  3.1640812  3.205667  3.38232
30   2.4899112  2.66132542  2.7016785  2.742031  2.91345
31   2.3652956  2.53186083  2.5710724  2.610284  2.77685
32   2.2382402  2.40029503  2.4384448  2.476594  2.63865
33   2.0486975  2.20653724  2.2436947  2.280852  2.43869
34   2.0511798  2.20522276  2.2414864  2.277750  2.43179
35   2.0553528  2.20601792  2.2414864  2.276955  2.42762
36   2.0385642  2.18623332  2.2209965  2.255760  2.40343
37   1.8391470  1.98414706  2.0182819  2.052417  2.19742
38   1.6312788  1.77395114  1.8075380  1.841125  1.98380
39   1.5314449  1.67192652  1.7049976  1.738069  1.87855
40   1.5208780  1.65927041  1.6918497  1.724429  1.86282
41   1.4986364  1.63513027  1.6672626  1.699395  1.83589
42   1.4498027  1.58470514  1.6164629  1.648221  1.78312
43   1.2247043  1.35830771  1.3897596  1.421211  1.55481
44   1.1772885  1.30980813  1.3410049  1.372202  1.50472
45   1.1781750  1.30997706  1.3410049  1.372033  1.50383
46   1.1786125  1.31005757  1.3410014  1.371945  1.50339
47   1.1644262  1.29555858  1.3264288  1.357299  1.48843
48   1.1223208  1.25286982  1.2836027  1.314336  1.44488
49   1.0583227  1.18805529  1.2185960  1.249137  1.37887
50   1.0360396  1.16504088  1.1954094  1.225778  1.35478
51   1.0366880  1.16516444  1.1954094  1.225654  1.35413
52   0.9728290  1.10089058  1.1310379  1.161185  1.28925
53   0.6458992  0.77387319  0.8039998  0.834127  0.96210
54   0.6278378  0.75589463  0.7860408  0.816187  0.94424
55   0.6233664  0.75144260  0.7815933  0.811744  0.93982
56   0.6203139  0.74853170  0.7787158  0.808900  0.93712
57   0.4831205  0.61171664  0.6419898  0.672263  0.80086
58   0.4152141  0.54435194  0.5747526  0.605153  0.73429
59   0.4143942  0.54419570  0.5747526  0.605309  0.73511
60   0.4133407  0.54399495  0.5747526  0.605510  0.73616
61   0.3912541  0.52305164  0.5540784  0.585105  0.71690
62   0.3615872  0.49479624  0.5261553  0.557514  0.69072
63   0.3595156  0.49440150  0.5261553  0.557909  0.69279
64   0.3572502  0.49396981  0.5261553  0.558341  0.69506
65   0.3545874  0.49346241  0.5261553  0.558848  0.69772
66   0.3515435  0.49288238  0.5261553  0.559428  0.70077
67   0.3482098  0.49224713  0.5261553  0.560063  0.70410
68   0.3447026  0.49157882  0.5261553  0.560732  0.70761
69   0.3265062  0.47651151  0.5118246  0.547138  0.69714
70   0.2579257  0.41132297  0.4474346  0.483546  0.63694
71   0.2081857  0.36515737  0.4021105  0.439064  0.59604
72   0.1349572  0.29569526  0.3335350  0.371375  0.53211
73   0.0020438  0.16674762  0.2055209  0.244294  0.40900
74  -0.0243664  0.14460810  0.1843868  0.224166  0.39314
75  -0.0362635  0.13720915  0.1780468  0.218884  0.39236
76  -0.0421115  0.13609478  0.1780468  0.219999  0.39820
77  -0.0482083  0.13493301  0.1780468  0.221161  0.40430
78  -0.0546034  0.13371440  0.1780468  0.222379  0.41070
79  -0.0610386  0.13248816  0.1780468  0.223605  0.41713
80  -0.0674722  0.13126221  0.1780468  0.224831  0.42357
81  -0.0740291  0.13001276  0.1780468  0.226081  0.43012
82  -0.0809567  0.12869267  0.1780468  0.227401  0.43705
83  -0.0885308  0.12724941  0.1780468  0.228844  0.44462
84  -0.0966886  0.12569491  0.1780468  0.230399  0.45278
85  -0.1053882  0.12403716  0.1780468  0.232056  0.46148
86  -0.1147206  0.12225885  0.1780468  0.233835  0.47081
87  -0.1248842  0.12032213  0.1780468  0.235771  0.48098
88  -0.1360096  0.11820215  0.1780468  0.237891  0.49210
89  -0.1480747  0.11590310  0.1780468  0.240190  0.50417
90  -0.1611528  0.11337745  0.1780053  0.242633  0.51716
91  -0.1772967  0.10838384  0.1756366  0.242889  0.52857
92  -0.1976403  0.09964452  0.1696291  0.239614  0.53690
93  -0.2221958  0.08715720  0.1599828  0.232808  0.54216
94  -0.2510614  0.07090314  0.1466976  0.222492  0.54446
95  -0.2844042  0.05085051  0.1297736  0.208697  0.54395
96  -0.3224450  0.02695723  0.1092109  0.191465  0.54087
97  -0.3654434 -0.00082617  0.0850093  0.170845  0.53546
98  -0.4136843 -0.03255395  0.0571689  0.146892  0.52802
99  -0.4674640 -0.06828261  0.0256897  0.119662  0.51884
100 -0.5270786 -0.10806856 -0.0094284  0.089212  0.50822
knots :
 [1] -2.557 -1.812 -1.726 -1.384 -1.233 -1.082 -1.046 -1.009 -0.932 -0.902
[11] -0.877 -0.838 -0.813 -0.765 -0.707 -0.665 -0.568 -0.498 -0.460 -0.413
[21] -0.347 -0.333 -0.299 -0.274 -0.226 -0.089 -0.024 -0.011  0.063  0.094
[31]  0.118  0.136  0.231  0.285  0.328  0.392  0.460  0.473  0.517  0.551
[41]  0.602  0.623  0.692  0.715  0.742  0.787  0.812  0.892  0.934  0.988
[51]  1.070  1.162  1.178  1.276  1.402  1.655  1.877  1.988  2.047  2.573
coef  :
 [1]  12.6970155   7.6878537   6.0937652   4.3540061   3.7259911   3.7259911
 [7]   2.7408131   2.5727608   2.5727608   2.2478639   2.2414864   2.2414864
[13]   2.2414864   2.2414864   2.2414864   1.9875889   1.6964374   1.6964374
[19]   1.6623718   1.6623718   1.3410049   1.3410049   1.3410049   1.3410049
[25]   1.3410049   1.3410049   1.1954094   1.1954094   1.1954094   1.1954094
[31]   0.9829296   0.8091342   0.7815933   0.7815933   0.7815933   0.5747526
[37]   0.5747526   0.5747526   0.5747526   0.5747526   0.5261553   0.5261553
[43]   0.5261553   0.5261553   0.5261553   0.5261553   0.5261553   0.5261553
[49]   0.5261553   0.5261553   0.4273578   0.3741431   0.2060752   0.1780468
[55]   0.1780468   0.1780468   0.1780468   0.1780468   0.1780468   0.1780468
[61]  -0.0094285 432.6957858
> 1 - sum(cxy3 $ resid ^ 2) / sum((y - mean(y))^2) # R^2 = 98.36%
[1] 0.96502
> 
> cpuTime(cxy4 <- cobs(x,y, "decrease", lambda = 1e-6, nknots = 100))# ~ 3 sec.
Time elapsed: 0.066 
> 1 - sum(cxy4 $ resid ^ 2) / sum((y - mean(y))^2) # R^2 = 98.443%
[1] 0.96603
> 
> cpuTime(cxy5 <- cobs(x,y, "decrease", lambda = 1e-6, nknots = 150))# ~ 8.7 sec.
Time elapsed: 0.082 
> 1 - sum(cxy5 $ resid ^ 2) / sum((y - mean(y))^2) # R^2 = 98.4396%
[1] 0.96835
> 
> ## regularly spaced x :
> X <- seq(-1,1, len = 201)
> xx <- c(seq(-1.1, -1, len = 11), X,
+         seq( 1,  1.1, len = 11))
> y <- (fx <- exp(-X)) + rt(201,4)/4
> summaryCobs(cXy  <- cobs(X,y, "decrease"))
qbsks2():
 Performing general knot selection ...

 Deleting unnecessary knots ...
List of 24
 $ call         : language cobs(x = X, y = y, constraint = "decrease")
 $ tau          : num 0.5
 $ degree       : num 2
 $ constraint   : chr "decrease"
 $ ic           : chr "AIC"
 $ pointwise    : NULL
 $ select.knots : logi TRUE
 $ select.lambda: logi FALSE
 $ x            : num [1:201] -1 -0.99 -0.98 -0.97 -0.96 -0.95 -0.94 -0.93 -0.92 -0.91 ...
 $ y            : num [1:201] 2.54 3.8 2.41 2.71 2.94 ...
 $ resid        : num [1:201] -0.0903 1.1895 -0.1774 0.1421 0.3931 ...
 $ fitted       : num [1:201] 2.63 2.61 2.59 2.57 2.55 ...
 $ coef         : num [1:3] 2.632 0.458 0.458
 $ knots        : num [1:2] -1 1
 $ k0           : num 3
 $ k            : num 3
 $ x.ps         :Formal class 'matrix.csr' [package "SparseM"] with 4 slots
 $ SSy          : num 111
 $ lambda       : num 0
 $ icyc         : int 9
 $ ifl          : int 1
 $ pp.lambda    : NULL
 $ pp.sic       : NULL
 $ i.mask       : NULL
      cb.lo   ci.lo     fit   ci.up   cb.up
1   2.45139 2.51251 2.63166 2.75080 2.81192
2   2.41415 2.47308 2.58797 2.70285 2.76178
3   2.37714 2.43396 2.54472 2.65548 2.71230
4   2.34037 2.39514 2.50192 2.60870 2.66347
5   2.30382 2.35662 2.45956 2.56250 2.61530
6   2.26749 2.31840 2.41764 2.51689 2.56780
7   2.23138 2.28047 2.37617 2.47187 2.52096
8   2.19549 2.24284 2.33514 2.42745 2.47480
9   2.15980 2.20549 2.29456 2.38363 2.42931
10  2.12432 2.16843 2.25442 2.34040 2.38451
11  2.08905 2.13166 2.21472 2.29778 2.34039
12  2.05397 2.09516 2.17547 2.25577 2.29696
13  2.01909 2.05895 2.13665 2.21436 2.25422
14  1.98439 2.02301 2.09829 2.17357 2.21218
15  1.94989 1.98735 2.06036 2.13338 2.17084
16  1.91558 1.95196 2.02288 2.09381 2.13019
17  1.88145 1.91685 1.98585 2.05485 2.09025
18  1.84751 1.88201 1.94926 2.01650 2.05100
19  1.81377 1.84745 1.91311 1.97877 2.01245
20  1.78022 1.81317 1.87740 1.94164 1.97458
21  1.74687 1.77917 1.84214 1.90511 1.93741
22  1.71372 1.74546 1.80732 1.86918 1.90092
23  1.68080 1.71204 1.77294 1.83385 1.86509
24  1.64810 1.67892 1.73901 1.79910 1.82993
25  1.61564 1.64611 1.70552 1.76494 1.79541
26  1.58343 1.61362 1.67248 1.73134 1.76153
27  1.55148 1.58145 1.63988 1.69830 1.72827
28  1.51982 1.54962 1.60772 1.66582 1.69562
29  1.48845 1.51814 1.57601 1.63388 1.66356
30  1.45740 1.48701 1.54474 1.60247 1.63208
31  1.42666 1.45624 1.51391 1.57158 1.60116
32  1.39627 1.42586 1.48353 1.54120 1.57078
33  1.36624 1.39586 1.45359 1.51132 1.54094
34  1.33658 1.36625 1.42409 1.48193 1.51161
35  1.30730 1.33705 1.39504 1.45303 1.48278
36  1.27842 1.30826 1.36643 1.42460 1.45444
37  1.24995 1.27990 1.33827 1.39664 1.42658
38  1.22191 1.25196 1.31054 1.36913 1.39918
39  1.19429 1.22446 1.28327 1.34208 1.37224
40  1.16711 1.19739 1.25643 1.31547 1.34575
41  1.14038 1.17078 1.23004 1.28930 1.31970
42  1.11411 1.14462 1.20409 1.26357 1.29407
43  1.08830 1.11891 1.17859 1.23826 1.26887
44  1.06297 1.09367 1.15353 1.21339 1.24409
45  1.03810 1.06889 1.12891 1.18893 1.21972
46  1.01371 1.04457 1.10474 1.16490 1.19576
47  0.98981 1.02073 1.08101 1.14128 1.17220
48  0.96639 0.99736 1.05772 1.11809 1.14905
49  0.94346 0.97445 1.03488 1.09530 1.12630
50  0.92101 0.95202 1.01248 1.07293 1.10394
51  0.89906 0.93007 0.99052 1.05098 1.08199
52  0.87759 0.90859 0.96901 1.02944 1.06043
53  0.85661 0.88758 0.94794 1.00831 1.03927
54  0.83612 0.86704 0.92732 0.98759 1.01851
55  0.81611 0.84697 0.90714 0.96730 0.99816
56  0.79659 0.82738 0.88740 0.94742 0.97821
57  0.77754 0.80825 0.86810 0.92796 0.95867
58  0.75897 0.78958 0.84925 0.90893 0.93954
59  0.74087 0.77137 0.83085 0.89032 0.92082
60  0.72323 0.75362 0.81288 0.87214 0.90254
61  0.70604 0.73632 0.79536 0.85440 0.88468
62  0.68931 0.71947 0.77828 0.83710 0.86726
63  0.67301 0.70307 0.76165 0.82024 0.85029
64  0.65715 0.68709 0.74546 0.80383 0.83377
65  0.64171 0.67155 0.72972 0.78789 0.81772
66  0.62668 0.65642 0.71441 0.77240 0.80215
67  0.61204 0.64171 0.69955 0.75740 0.78707
68  0.59779 0.62741 0.68514 0.74287 0.77249
69  0.58391 0.61350 0.67117 0.72884 0.75842
70  0.57039 0.59997 0.65764 0.71531 0.74489
71  0.55721 0.58682 0.64455 0.70228 0.73190
72  0.54436 0.57404 0.63191 0.68978 0.71947
73  0.53181 0.56162 0.61972 0.67782 0.70762
74  0.51957 0.54954 0.60796 0.66639 0.69636
75  0.50760 0.53779 0.59665 0.65551 0.68570
76  0.49590 0.52637 0.58578 0.64520 0.67567
77  0.48445 0.51527 0.57536 0.63545 0.66628
78  0.47323 0.50448 0.56538 0.62629 0.65753
79  0.46225 0.49398 0.55584 0.61771 0.64944
80  0.45148 0.48378 0.54675 0.60972 0.64202
81  0.44092 0.47387 0.53810 0.60234 0.63529
82  0.43056 0.46424 0.52990 0.59556 0.62924
83  0.42039 0.45489 0.52213 0.58938 0.62388
84  0.41042 0.44581 0.51482 0.58382 0.61921
85  0.40063 0.43702 0.50794 0.57887 0.61525
86  0.39104 0.42849 0.50151 0.57453 0.61198
87  0.38163 0.42024 0.49552 0.57080 0.60942
88  0.37241 0.41227 0.48998 0.56769 0.60755
89  0.36338 0.40457 0.48488 0.56518 0.60637
90  0.35455 0.39716 0.48022 0.56328 0.60589
91  0.34591 0.39002 0.47601 0.56199 0.60610
92  0.33748 0.38317 0.47224 0.56130 0.60699
93  0.32925 0.37660 0.46891 0.56122 0.60857
94  0.32123 0.37032 0.46603 0.56173 0.61082
95  0.31343 0.36434 0.46359 0.56283 0.61374
96  0.30585 0.35865 0.46159 0.56453 0.61733
97  0.29849 0.35326 0.46004 0.56682 0.62159
98  0.29135 0.34817 0.45893 0.56969 0.62651
99  0.28445 0.34338 0.45826 0.57315 0.63208
100 0.27778 0.33890 0.45804 0.57719 0.63830
knots :
[1] -1  1
coef  :
[1] 2.63166 0.45804 0.45804
> 1 - sum(cXy $ resid ^ 2) / sum((y - mean(y))^2) # R^2 = 77.2%
[1] 0.79777
> 
> (cXy.9 <- cobs(X,y, "decrease", tau = 0.9))
qbsks2():
 Performing general knot selection ...

 Deleting unnecessary knots ...
COBS regression spline (degree = 2) from call:
	 cobs(x = X, y = y, constraint = "decrease", tau = 0.9)
{tau=0.9}-quantile;  dimensionality of fit: 3 from {3}
x$knots[1:2]: -1,  1
> (cXy.1 <- cobs(X,y, "decrease", tau = 0.1))
qbsks2():
 Performing general knot selection ...

 Deleting unnecessary knots ...
COBS regression spline (degree = 2) from call:
	 cobs(x = X, y = y, constraint = "decrease", tau = 0.1)
{tau=0.1}-quantile;  dimensionality of fit: 4 from {4}
x$knots[1:3]: -1.0, -0.2,  1.0
> (cXy.99<- cobs(X,y, "decrease", tau = 0.99))
qbsks2():
 Performing general knot selection ...

 Deleting unnecessary knots ...
COBS regression spline (degree = 2) from call:
	 cobs(x = X, y = y, constraint = "decrease", tau = 0.99)
{tau=0.99}-quantile;  dimensionality of fit: 6 from {6}
x$knots[1:5]: -1.0, -0.6, -0.2,  0.2,  1.0
> (cXy.01<- cobs(X,y, "decrease", tau = 0.01))
qbsks2():
 Performing general knot selection ...

 Deleting unnecessary knots ...
COBS regression spline (degree = 2) from call:
	 cobs(x = X, y = y, constraint = "decrease", tau = 0.01)
{tau=0.01}-quantile;  dimensionality of fit: 6 from {6}
x$knots[1:5]: -1.0, -0.6, -0.2,  0.2,  1.0
> plot(X,y, xlim = range(xx),
+      main = "cobs(*, \"decrease\"), N=201, tau = 50% (Med.), 1,10, 90,99%")
> lines(predict(cXy,    xx), col = 2)
> lines(predict(cXy.1,  xx), col = 3)
> lines(predict(cXy.9,  xx), col = 3)
> lines(predict(cXy.01, xx), col = 4)
> lines(predict(cXy.99, xx), col = 4)
> 
> ## Interpolation
> cpuTime(cXyI  <- cobs(X,y, "decrease", knots = unique(X)))
qbsks2():
 Performing general knot selection ...

 Deleting unnecessary knots ...
Time elapsed: 7.277 
Warning message:
In cobs(X, y, "decrease", knots = unique(X)) :
  The number of knots can't be equal to the number of unique x for degree = 2.
'cobs' has automatically deleted the middle knot.
> ## takes ~ 47 sec. (Pent. III, 700 MHz)
> summaryCobs(cXyI)# only 7 knots remaining!
List of 24
 $ call         : language cobs(x = X, y = y, constraint = "decrease", knots = unique(X))
 $ tau          : num 0.5
 $ degree       : num 2
 $ constraint   : chr "decrease"
 $ ic           : chr "AIC"
 $ pointwise    : NULL
 $ select.knots : logi TRUE
 $ select.lambda: logi FALSE
 $ x            : num [1:201] -1 -0.99 -0.98 -0.97 -0.96 -0.95 -0.94 -0.93 -0.92 -0.91 ...
 $ y            : num [1:201] 2.54 3.8 2.41 2.71 2.94 ...
 $ resid        : num [1:201] -0.0903 1.1895 -0.1774 0.1421 0.3931 ...
 $ fitted       : num [1:201] 2.63 2.61 2.59 2.57 2.55 ...
 $ coef         : num [1:3] 2.632 0.458 0.458
 $ knots        : num [1:2] -1 1
 $ k0           : num 3
 $ k            : num 3
 $ x.ps         :Formal class 'matrix.csr' [package "SparseM"] with 4 slots
 $ SSy          : num 111
 $ lambda       : num 0
 $ icyc         : int 9
 $ ifl          : int 1
 $ pp.lambda    : NULL
 $ pp.sic       : NULL
 $ i.mask       : NULL
      cb.lo   ci.lo     fit   ci.up   cb.up
1   2.45139 2.51251 2.63166 2.75080 2.81192
2   2.41415 2.47308 2.58797 2.70285 2.76178
3   2.37714 2.43396 2.54472 2.65548 2.71230
4   2.34037 2.39514 2.50192 2.60870 2.66347
5   2.30382 2.35662 2.45956 2.56250 2.61530
6   2.26749 2.31840 2.41764 2.51689 2.56780
7   2.23138 2.28047 2.37617 2.47187 2.52096
8   2.19549 2.24284 2.33514 2.42745 2.47480
9   2.15980 2.20549 2.29456 2.38363 2.42931
10  2.12432 2.16843 2.25442 2.34040 2.38451
11  2.08905 2.13166 2.21472 2.29778 2.34039
12  2.05397 2.09516 2.17547 2.25577 2.29696
13  2.01909 2.05895 2.13665 2.21436 2.25422
14  1.98439 2.02301 2.09829 2.17357 2.21218
15  1.94989 1.98735 2.06036 2.13338 2.17084
16  1.91558 1.95196 2.02288 2.09381 2.13019
17  1.88145 1.91685 1.98585 2.05485 2.09025
18  1.84751 1.88201 1.94926 2.01650 2.05100
19  1.81377 1.84745 1.91311 1.97877 2.01245
20  1.78022 1.81317 1.87740 1.94164 1.97458
21  1.74687 1.77917 1.84214 1.90511 1.93741
22  1.71372 1.74546 1.80732 1.86918 1.90092
23  1.68080 1.71204 1.77294 1.83385 1.86509
24  1.64810 1.67892 1.73901 1.79910 1.82993
25  1.61564 1.64611 1.70552 1.76494 1.79541
26  1.58343 1.61362 1.67248 1.73134 1.76153
27  1.55148 1.58145 1.63988 1.69830 1.72827
28  1.51982 1.54962 1.60772 1.66582 1.69562
29  1.48845 1.51814 1.57601 1.63388 1.66356
30  1.45740 1.48701 1.54474 1.60247 1.63208
31  1.42666 1.45624 1.51391 1.57158 1.60116
32  1.39627 1.42586 1.48353 1.54120 1.57078
33  1.36624 1.39586 1.45359 1.51132 1.54094
34  1.33658 1.36625 1.42409 1.48193 1.51161
35  1.30730 1.33705 1.39504 1.45303 1.48278
36  1.27842 1.30826 1.36643 1.42460 1.45444
37  1.24995 1.27990 1.33827 1.39664 1.42658
38  1.22191 1.25196 1.31054 1.36913 1.39918
39  1.19429 1.22446 1.28327 1.34208 1.37224
40  1.16711 1.19739 1.25643 1.31547 1.34575
41  1.14038 1.17078 1.23004 1.28930 1.31970
42  1.11411 1.14462 1.20409 1.26357 1.29407
43  1.08830 1.11891 1.17859 1.23826 1.26887
44  1.06297 1.09367 1.15353 1.21339 1.24409
45  1.03810 1.06889 1.12891 1.18893 1.21972
46  1.01371 1.04457 1.10474 1.16490 1.19576
47  0.98981 1.02073 1.08101 1.14128 1.17220
48  0.96639 0.99736 1.05772 1.11809 1.14905
49  0.94346 0.97445 1.03488 1.09530 1.12630
50  0.92101 0.95202 1.01248 1.07293 1.10394
51  0.89906 0.93007 0.99052 1.05098 1.08199
52  0.87759 0.90859 0.96901 1.02944 1.06043
53  0.85661 0.88758 0.94794 1.00831 1.03927
54  0.83612 0.86704 0.92732 0.98759 1.01851
55  0.81611 0.84697 0.90714 0.96730 0.99816
56  0.79659 0.82738 0.88740 0.94742 0.97821
57  0.77754 0.80825 0.86810 0.92796 0.95867
58  0.75897 0.78958 0.84925 0.90893 0.93954
59  0.74087 0.77137 0.83085 0.89032 0.92082
60  0.72323 0.75362 0.81288 0.87214 0.90254
61  0.70604 0.73632 0.79536 0.85440 0.88468
62  0.68931 0.71947 0.77828 0.83710 0.86726
63  0.67301 0.70307 0.76165 0.82024 0.85029
64  0.65715 0.68709 0.74546 0.80383 0.83377
65  0.64171 0.67155 0.72972 0.78789 0.81772
66  0.62668 0.65642 0.71441 0.77240 0.80215
67  0.61204 0.64171 0.69955 0.75740 0.78707
68  0.59779 0.62741 0.68514 0.74287 0.77249
69  0.58391 0.61350 0.67117 0.72884 0.75842
70  0.57039 0.59997 0.65764 0.71531 0.74489
71  0.55721 0.58682 0.64455 0.70228 0.73190
72  0.54436 0.57404 0.63191 0.68978 0.71947
73  0.53181 0.56162 0.61972 0.67782 0.70762
74  0.51957 0.54954 0.60796 0.66639 0.69636
75  0.50760 0.53779 0.59665 0.65551 0.68570
76  0.49590 0.52637 0.58578 0.64520 0.67567
77  0.48445 0.51527 0.57536 0.63545 0.66628
78  0.47323 0.50448 0.56538 0.62629 0.65753
79  0.46225 0.49398 0.55584 0.61771 0.64944
80  0.45148 0.48378 0.54675 0.60972 0.64202
81  0.44092 0.47387 0.53810 0.60234 0.63529
82  0.43056 0.46424 0.52990 0.59556 0.62924
83  0.42039 0.45489 0.52213 0.58938 0.62388
84  0.41042 0.44581 0.51482 0.58382 0.61921
85  0.40063 0.43702 0.50794 0.57887 0.61525
86  0.39104 0.42849 0.50151 0.57453 0.61198
87  0.38163 0.42024 0.49552 0.57080 0.60942
88  0.37241 0.41227 0.48998 0.56769 0.60755
89  0.36338 0.40457 0.48488 0.56518 0.60637
90  0.35455 0.39716 0.48022 0.56328 0.60589
91  0.34591 0.39002 0.47601 0.56199 0.60610
92  0.33748 0.38317 0.47224 0.56130 0.60699
93  0.32925 0.37660 0.46891 0.56122 0.60857
94  0.32123 0.37032 0.46603 0.56173 0.61082
95  0.31343 0.36434 0.46359 0.56283 0.61374
96  0.30585 0.35865 0.46159 0.56453 0.61733
97  0.29849 0.35326 0.46004 0.56682 0.62159
98  0.29135 0.34817 0.45893 0.56969 0.62651
99  0.28445 0.34338 0.45826 0.57315 0.63208
100 0.27778 0.33890 0.45804 0.57719 0.63830
knots :
[1] -1  1
coef  :
[1] 2.63166 0.45804 0.45804
> 
> summaryCobs(cXy1 <- cobs(X,y, "decrease", lambda= 0.1))
List of 24
 $ call         : language cobs(x = X, y = y, constraint = "decrease", lambda = 0.1)
 $ tau          : num 0.5
 $ degree       : num 2
 $ constraint   : chr "decrease"
 $ ic           : NULL
 $ pointwise    : NULL
 $ select.knots : logi TRUE
 $ select.lambda: logi FALSE
 $ x            : num [1:201] -1 -0.99 -0.98 -0.97 -0.96 -0.95 -0.94 -0.93 -0.92 -0.91 ...
 $ y            : num [1:201] 2.54 3.8 2.41 2.71 2.94 ...
 $ resid        : num [1:201] -0.238 1.044 -0.322 0 0.253 ...
 $ fitted       : num [1:201] 2.78 2.76 2.73 2.71 2.69 ...
 $ coef         : num [1:22] 2.78 2.66 2.39 2.13 1.91 ...
 $ knots        : num [1:20] -1 -0.9 -0.79 -0.69 -0.58 -0.48 -0.37 -0.27 -0.16 -0.06 ...
 $ k0           : int 9
 $ k            : int 9
 $ x.ps         :Formal class 'matrix.csr' [package "SparseM"] with 4 slots
 $ SSy          : num 111
 $ lambda       : num 0.1
 $ icyc         : int 20
 $ ifl          : int 1
 $ pp.lambda    : NULL
 $ pp.sic       : NULL
 $ i.mask       : NULL
      cb.lo   ci.lo     fit   ci.up   cb.up
1   2.57842 2.69241 2.77887 2.86533 2.97931
2   2.53574 2.64745 2.73219 2.81692 2.92864
3   2.49168 2.60118 2.68423 2.76729 2.87679
4   2.44624 2.55358 2.63500 2.71641 2.82375
5   2.39942 2.50466 2.58448 2.66430 2.76954
6   2.35123 2.45442 2.53269 2.61096 2.71415
7   2.30264 2.40384 2.48060 2.55736 2.65856
8   2.25443 2.35371 2.42901 2.50430 2.60358
9   2.20664 2.30404 2.37791 2.45179 2.54919
10  2.15924 2.25482 2.32732 2.39982 2.49540
11  2.11225 2.20607 2.27723 2.34840 2.44222
12  2.06580 2.15792 2.22779 2.29766 2.38977
13  2.02046 2.11093 2.17956 2.24818 2.33865
14  1.97630 2.06519 2.13261 2.20002 2.28891
15  1.93333 2.02068 2.08693 2.15319 2.24054
16  1.89153 1.97740 2.04254 2.10768 2.19355
17  1.85091 1.93537 1.99943 2.06348 2.14794
18  1.81147 1.89456 1.95759 2.02062 2.10371
19  1.77321 1.85500 1.91703 1.97906 2.06085
20  1.73614 1.81667 1.87775 1.93883 2.01936
21  1.70026 1.77958 1.83975 1.89991 1.97924
22  1.66557 1.74374 1.80303 1.86232 1.94048
23  1.63206 1.70913 1.76758 1.82604 1.90310
24  1.59973 1.67575 1.73342 1.79108 1.86710
25  1.56860 1.64362 1.70053 1.75743 1.83245
26  1.53866 1.61273 1.66892 1.72510 1.79918
27  1.50982 1.58300 1.63850 1.69401 1.76718
28  1.48032 1.55265 1.60751 1.66237 1.73470
29  1.44946 1.52098 1.57523 1.62948 1.70101
30  1.41724 1.48801 1.54168 1.59536 1.66612
31  1.38368 1.45372 1.50685 1.55998 1.63002
32  1.34876 1.41813 1.47074 1.52336 1.59272
33  1.31333 1.38207 1.43420 1.48634 1.55507
34  1.27906 1.34721 1.39890 1.45059 1.51873
35  1.24600 1.31360 1.36487 1.41615 1.48374
36  1.21415 1.28124 1.33213 1.38301 1.45010
37  1.18351 1.25013 1.30066 1.35119 1.41781
38  1.15407 1.22026 1.27047 1.32068 1.38687
39  1.12584 1.19164 1.24156 1.29147 1.35727
40  1.09884 1.16428 1.21392 1.26356 1.32901
41  1.07306 1.13818 1.18757 1.23696 1.30208
42  1.04850 1.11332 1.16249 1.21166 1.27648
43  1.02505 1.08962 1.13859 1.18756 1.25212
44  1.00179 1.06613 1.11493 1.16373 1.22807
45  0.97851 1.04266 1.09131 1.13997 1.20412
46  0.95521 1.01920 1.06774 1.11627 1.18026
47  0.93189 0.99576 1.04420 1.09264 1.15651
48  0.90869 0.97247 1.02084 1.06922 1.13300
49  0.88654 0.95026 0.99859 1.04692 1.11064
50  0.86561 0.92930 0.97762 1.02593 1.08962
51  0.84592 0.90961 0.95792 1.00623 1.06992
52  0.82746 0.89117 0.93950 0.98783 1.05155
53  0.81022 0.87399 0.92236 0.97073 1.03451
54  0.79387 0.85773 0.90617 0.95461 1.01847
55  0.77809 0.84208 0.89062 0.93915 1.00314
56  0.76291 0.82705 0.87570 0.92436 0.98850
57  0.74830 0.81264 0.86143 0.91023 0.97456
58  0.73428 0.79884 0.84781 0.89677 0.96133
59  0.72086 0.78568 0.83484 0.88401 0.94883
60  0.70807 0.77318 0.82257 0.87196 0.93707
61  0.69592 0.76135 0.81099 0.86062 0.92606
62  0.68439 0.75018 0.80009 0.84999 0.91578
63  0.67350 0.73968 0.78988 0.84007 0.90625
64  0.66283 0.72944 0.77996 0.83048 0.89709
65  0.65095 0.71803 0.76890 0.81978 0.88686
66  0.63772 0.70530 0.75657 0.80783 0.87542
67  0.62314 0.69127 0.74295 0.79463 0.86277
68  0.60721 0.67593 0.72806 0.78019 0.84891
69  0.59051 0.65987 0.71248 0.76509 0.83445
70  0.57489 0.64492 0.69805 0.75117 0.82121
71  0.56047 0.63122 0.68489 0.73856 0.80931
72  0.54726 0.61877 0.67302 0.72726 0.79877
73  0.53525 0.60757 0.66242 0.71727 0.78959
74  0.52441 0.59758 0.65307 0.70857 0.78173
75  0.51408 0.58814 0.64432 0.70050 0.77457
76  0.50397 0.57898 0.63588 0.69278 0.76780
77  0.49408 0.57010 0.62775 0.68541 0.76143
78  0.48442 0.56148 0.61994 0.67839 0.75546
79  0.47491 0.55308 0.61237 0.67166 0.74983
80  0.46443 0.54376 0.60393 0.66409 0.74342
81  0.45259 0.53312 0.59421 0.65529 0.73582
82  0.43938 0.52117 0.58321 0.64525 0.72704
83  0.42480 0.50790 0.57093 0.63396 0.71706
84  0.40884 0.49331 0.55738 0.62144 0.70591
85  0.39241 0.47830 0.54344 0.60859 0.69448
86  0.37712 0.46449 0.53076 0.59703 0.68440
87  0.36301 0.45192 0.51935 0.58679 0.67569
88  0.35008 0.44058 0.50922 0.57786 0.66836
89  0.33833 0.43048 0.50037 0.57026 0.66241
90  0.32717 0.42102 0.49221 0.56340 0.65726
91  0.31570 0.41132 0.48385 0.55638 0.65200
92  0.30393 0.40138 0.47529 0.54920 0.64664
93  0.29186 0.39118 0.46651 0.54185 0.64117
94  0.27948 0.38073 0.45753 0.53434 0.63559
95  0.26668 0.36993 0.44824 0.52655 0.62980
96  0.25266 0.35796 0.43783 0.51770 0.62301
97  0.23726 0.34468 0.42615 0.50762 0.61503
98  0.22049 0.33007 0.41318 0.49630 0.60587
99  0.20234 0.31414 0.39894 0.48374 0.59554
100 0.18281 0.29689 0.38342 0.46995 0.58403
knots :
 [1] -1.00 -0.90 -0.79 -0.69 -0.58 -0.48 -0.37 -0.27 -0.16 -0.06  0.05  0.15
[13]  0.26  0.36  0.47  0.57  0.68  0.78  0.89  1.00
coef  :
 [1] 2.77887 2.66492 2.39273 2.13472 1.90960 1.72066 1.56461 1.37238 1.21304
[10] 1.08989 0.96778 0.88186 0.81244 0.76248 0.67962 0.63295 0.59429 0.51945
[19] 0.47751 0.42742 0.38342 3.13257
> 1 - sum(cXy1 $ resid ^ 2) / sum((y - mean(y))^2) # R^2 = 79.53 %
[1] 0.80392
> 
> summaryCobs(cXy2 <- cobs(X,y, "decrease", lambda= 1e-2))
List of 24
 $ call         : language cobs(x = X, y = y, constraint = "decrease", lambda = 0.01)
 $ tau          : num 0.5
 $ degree       : num 2
 $ constraint   : chr "decrease"
 $ ic           : NULL
 $ pointwise    : NULL
 $ select.knots : logi TRUE
 $ select.lambda: logi FALSE
 $ x            : num [1:201] -1 -0.99 -0.98 -0.97 -0.96 -0.95 -0.94 -0.93 -0.92 -0.91 ...
 $ y            : num [1:201] 2.54 3.8 2.41 2.71 2.94 ...
 $ resid        : num [1:201] -0.197 1.068 -0.311 0 0.245 ...
 $ fitted       : num [1:201] 2.74 2.73 2.72 2.71 2.69 ...
 $ coef         : num [1:22] 2.74 2.71 2.37 2.23 1.81 ...
 $ knots        : num [1:20] -1 -0.9 -0.79 -0.69 -0.58 -0.48 -0.37 -0.27 -0.16 -0.06 ...
 $ k0           : int 18
 $ k            : int 18
 $ x.ps         :Formal class 'matrix.csr' [package "SparseM"] with 4 slots
 $ SSy          : num 111
 $ lambda       : num 0.01
 $ icyc         : int 33
 $ ifl          : int 1
 $ pp.lambda    : NULL
 $ pp.sic       : NULL
 $ i.mask       : NULL
      cb.lo   ci.lo     fit   ci.up   cb.up
1   2.49645 2.66021 2.73880 2.81739 2.98114
2   2.48392 2.64442 2.72144 2.79846 2.95896
3   2.46035 2.61766 2.69316 2.76865 2.92596
4   2.42573 2.57994 2.65395 2.72796 2.88216
5   2.38007 2.53125 2.60381 2.67637 2.82755
6   2.32338 2.47162 2.54277 2.61392 2.76216
7   2.26558 2.41097 2.48074 2.55052 2.69591
8   2.21483 2.35745 2.42590 2.49435 2.63696
9   2.17116 2.31109 2.37824 2.44540 2.58533
10  2.13455 2.27187 2.33777 2.40367 2.54099
11  2.10501 2.23980 2.30449 2.36917 2.50396
12  2.07922 2.21156 2.27507 2.33859 2.47092
13  2.04379 2.17377 2.23615 2.29853 2.42850
14  1.99732 2.12501 2.18629 2.24758 2.37527
15  1.93980 2.06529 2.12552 2.18574 2.31123
16  1.87123 1.99460 2.05381 2.11302 2.23639
17  1.79630 1.91763 1.97587 2.03410 2.15543
18  1.73088 1.85025 1.90755 1.96484 2.08421
19  1.67627 1.79376 1.85015 1.90654 2.02404
20  1.63247 1.74816 1.80369 1.85921 1.97490
21  1.59950 1.71346 1.76815 1.82284 1.93679
22  1.57713 1.68943 1.74333 1.79722 1.90952
23  1.55913 1.66985 1.72298 1.77612 1.88684
24  1.54256 1.65178 1.70419 1.75661 1.86582
25  1.52745 1.63523 1.68695 1.73868 1.84646
26  1.51377 1.62019 1.67126 1.72233 1.82875
27  1.50127 1.60640 1.65685 1.70730 1.81243
28  1.48427 1.58818 1.63805 1.68792 1.79183
29  1.46055 1.56330 1.61262 1.66193 1.76469
30  1.43010 1.53177 1.58056 1.62935 1.73101
31  1.39295 1.49358 1.54187 1.59016 1.69079
32  1.34907 1.44873 1.49655 1.54438 1.64403
33  1.30104 1.39979 1.44718 1.49457 1.59331
34  1.25390 1.35180 1.39879 1.44577 1.54367
35  1.20780 1.30491 1.35152 1.39812 1.49523
36  1.16272 1.25910 1.30536 1.35162 1.44800
37  1.11868 1.21439 1.26032 1.30625 1.40196
38  1.07829 1.17339 1.21903 1.26467 1.35976
39  1.04591 1.14044 1.18581 1.23118 1.32572
40  1.02159 1.11561 1.16074 1.20586 1.29988
41  1.00535 1.09890 1.14380 1.18870 1.28225
42  0.99719 1.09032 1.13501 1.17970 1.27283
43  0.99541 1.08816 1.13268 1.17719 1.26994
44  0.98583 1.07826 1.12262 1.16698 1.25942
45  0.96526 1.05742 1.10165 1.14587 1.23803
46  0.93369 1.02562 1.06974 1.11386 1.20579
47  0.89112 0.98287 1.02691 1.07094 1.16270
48  0.83986 0.93148 0.97545 1.01943 1.11105
49  0.79552 0.88707 0.93100 0.97494 1.06648
50  0.76107 0.85257 0.89649 0.94040 1.03191
51  0.73649 0.82799 0.87190 0.91582 1.00732
52  0.72178 0.81332 0.85725 0.90118 0.99272
53  0.71694 0.80856 0.85253 0.89650 0.98812
54  0.71675 0.80850 0.85253 0.89656 0.98831
55  0.71649 0.80841 0.85253 0.89665 0.98857
56  0.71615 0.80830 0.85253 0.89675 0.98891
57  0.71575 0.80817 0.85253 0.89688 0.98931
58  0.71527 0.80802 0.85253 0.89704 0.98979
59  0.71472 0.80784 0.85253 0.89722 0.99034
60  0.71409 0.80764 0.85253 0.89742 0.99097
61  0.71340 0.80741 0.85253 0.89765 0.99165
62  0.71265 0.80717 0.85253 0.89789 0.99241
63  0.71182 0.80690 0.85253 0.89816 0.99324
64  0.70916 0.80486 0.85078 0.89671 0.99240
65  0.69821 0.79458 0.84083 0.88708 0.98344
66  0.67837 0.77547 0.82207 0.86867 0.96576
67  0.64964 0.74752 0.79450 0.84148 0.93936
68  0.61201 0.71074 0.75812 0.80551 0.90424
69  0.56936 0.66901 0.71683 0.76465 0.86429
70  0.53377 0.63439 0.68268 0.73097 0.83158
71  0.50610 0.60775 0.65654 0.70532 0.80697
72  0.48635 0.58909 0.63840 0.68771 0.79045
73  0.47452 0.57841 0.62827 0.67813 0.78202
74  0.47037 0.57548 0.62593 0.67637 0.78149
75  0.46846 0.57486 0.62593 0.67700 0.78340
76  0.46643 0.57421 0.62593 0.67765 0.78542
77  0.46431 0.57352 0.62593 0.67834 0.78755
78  0.46208 0.57279 0.62593 0.67906 0.78978
79  0.45951 0.57181 0.62570 0.67960 0.79190
80  0.45273 0.56669 0.62139 0.67608 0.79004
81  0.44035 0.55604 0.61157 0.66709 0.78279
82  0.42235 0.53986 0.59625 0.65264 0.77015
83  0.39875 0.51813 0.57543 0.63273 0.75211
84  0.36953 0.49087 0.54911 0.60735 0.72870
85  0.33876 0.46215 0.52137 0.58059 0.70398
86  0.31377 0.43929 0.49953 0.55977 0.68528
87  0.29471 0.42244 0.48374 0.54503 0.67276
88  0.28159 0.41160 0.47400 0.53639 0.66640
89  0.27439 0.40677 0.47031 0.53384 0.66622
90  0.27072 0.40556 0.47027 0.53498 0.66982
91  0.26697 0.40434 0.47027 0.53620 0.67357
92  0.26309 0.40308 0.47027 0.53745 0.67744
93  0.25910 0.40179 0.47027 0.53875 0.68143
94  0.25499 0.40046 0.47027 0.54008 0.68555
95  0.25017 0.39850 0.46969 0.54088 0.68921
96  0.24027 0.39155 0.46415 0.53676 0.68804
97  0.22439 0.37870 0.45276 0.52681 0.68113
98  0.20253 0.35995 0.43550 0.51105 0.66847
99  0.17469 0.33531 0.41239 0.48947 0.65008
100 0.14088 0.30476 0.38342 0.46207 0.62596
knots :
 [1] -1.00 -0.90 -0.79 -0.69 -0.58 -0.48 -0.37 -0.27 -0.16 -0.06  0.05  0.15
[13]  0.26  0.36  0.47  0.57  0.68  0.78  0.89  1.00
coef  :
 [1]  2.73880  2.70936  2.36642  2.22686  1.80618  1.69472  1.62318  1.36404
 [9]  1.13364  1.13364  0.85253  0.85253  0.85253  0.85253  0.62593  0.62593
[17]  0.62593  0.47027  0.47027  0.47027  0.38342 26.77253
> 1 - sum(cXy2 $ resid ^ 2) / sum((y - mean(y))^2) # R^2 = 80.004%
[1] 0.80865
> 
> summaryCobs(cXy3 <- cobs(X,y, "decrease", lambda= 1e-6, nknots = 60))
List of 24
 $ call         : language cobs(x = X, y = y, constraint = "decrease", nknots = 60, lambda = 1e-06)
 $ tau          : num 0.5
 $ degree       : num 2
 $ constraint   : chr "decrease"
 $ ic           : NULL
 $ pointwise    : NULL
 $ select.knots : logi TRUE
 $ select.lambda: logi FALSE
 $ x            : num [1:201] -1 -0.99 -0.98 -0.97 -0.96 -0.95 -0.94 -0.93 -0.92 -0.91 ...
 $ y            : num [1:201] 2.54 3.8 2.41 2.71 2.94 ...
 $ resid        : num [1:201] -0.168 1.09 -0.298 0 0.23 ...
 $ fitted       : num [1:201] 2.71 2.71 2.71 2.71 2.71 ...
 $ coef         : num [1:62] 2.71 2.71 2.71 2.71 2.6 2.25 2.25 2.25 2.25 2.06 ...
 $ knots        : num [1:60] -1 -0.97 -0.94 -0.9 -0.87 -0.84 -0.8 -0.77 -0.73 -0.7 ...
 $ k0           : int 61
 $ k            : int 61
 $ x.ps         :Formal class 'matrix.csr' [package "SparseM"] with 4 slots
 $ SSy          : num 111
 $ lambda       : num 1e-06
 $ icyc         : int 50
 $ ifl          : int 1
 $ pp.lambda    : NULL
 $ pp.sic       : NULL
 $ i.mask       : NULL
       cb.lo   ci.lo     fit   ci.up   cb.up
1   2.401785 2.65053 2.70908 2.76764 3.01638
2   2.406430 2.65142 2.70908 2.76675 3.01174
3   2.410980 2.65228 2.70908 2.76589 3.00719
4   2.415422 2.65312 2.70907 2.76502 3.00272
5   2.403269 2.63743 2.69256 2.74768 2.98184
6   2.359752 2.59046 2.64477 2.69908 2.92979
7   2.238249 2.46558 2.51910 2.57261 2.79994
8   2.044078 2.26811 2.32085 2.37359 2.59762
9   1.981232 2.20204 2.25402 2.30600 2.52681
10  1.985116 2.20278 2.25402 2.30526 2.52293
11  1.988907 2.20351 2.25402 2.30454 2.51914
12  1.992602 2.20421 2.25402 2.30384 2.51544
13  1.985609 2.19431 2.24343 2.29256 2.50126
14  1.926662 2.13252 2.18098 2.22944 2.43530
15  1.837952 2.04105 2.08886 2.13667 2.33977
16  1.813586 2.01400 2.06118 2.10836 2.30877
17  1.776542 1.97435 2.02092 2.06748 2.26530
18  1.685269 1.88056 1.92653 1.97250 2.16779
19  1.565321 1.75816 1.80355 1.84895 2.04179
20  1.447768 1.63823 1.68307 1.72790 1.91837
21  1.419426 1.60760 1.65189 1.69619 1.88436
22  1.422166 1.60812 1.65189 1.69567 1.88162
23  1.424816 1.60862 1.65189 1.69516 1.87897
24  1.427370 1.60911 1.65189 1.69467 1.87642
25  1.429824 1.60958 1.65189 1.69421 1.87396
26  1.432178 1.61003 1.65189 1.69376 1.87161
27  1.434440 1.61046 1.65189 1.69333 1.86935
28  1.435729 1.60999 1.65101 1.69203 1.86629
29  1.419138 1.59172 1.63234 1.67297 1.84555
30  1.391277 1.56226 1.60250 1.64275 1.81373
31  1.380530 1.54998 1.58987 1.62975 1.79920
32  1.342011 1.51000 1.54955 1.58910 1.75709
33  1.195341 1.36196 1.40118 1.44040 1.60702
34  1.114892 1.28022 1.31913 1.35805 1.52338
35  1.114714 1.27882 1.31745 1.35608 1.52019
36  1.116129 1.27909 1.31745 1.35581 1.51878
37  1.085255 1.24715 1.28526 1.32337 1.48526
38  0.979174 1.14008 1.17795 1.21583 1.37673
39  0.926118 1.08611 1.12377 1.16144 1.32143
40  0.926562 1.08573 1.12319 1.16066 1.31982
41  0.927502 1.08590 1.12319 1.16048 1.31888
42  0.928350 1.08607 1.12319 1.16032 1.31803
43  0.929098 1.08621 1.12319 1.16018 1.31729
44  0.929758 1.08633 1.12319 1.16005 1.31663
45  0.930331 1.08644 1.12319 1.15994 1.31605
46  0.930806 1.08653 1.12319 1.15985 1.31558
47  0.931179 1.08661 1.12319 1.15978 1.31521
48  0.922326 1.07753 1.11407 1.15060 1.30580
49  0.842354 0.99741 1.03391 1.07041 1.22546
50  0.702806 0.85778 0.89426 0.93074 1.08571
51  0.648265 0.80324 0.83972 0.87620 1.03117
52  0.648171 0.80322 0.83972 0.87622 1.03127
53  0.647992 0.80319 0.83972 0.87625 1.03145
54  0.647719 0.80313 0.83972 0.87630 1.03172
55  0.647345 0.80306 0.83972 0.87637 1.03209
56  0.646863 0.80297 0.83971 0.87646 1.03256
57  0.643705 0.80027 0.83712 0.87398 1.03054
58  0.635825 0.79292 0.82989 0.86687 1.02396
59  0.629414 0.78711 0.82423 0.86135 1.01905
60  0.628044 0.78643 0.82371 0.86099 1.01937
61  0.627110 0.78625 0.82371 0.86117 1.02031
62  0.626086 0.78605 0.82371 0.86136 1.02133
63  0.624962 0.78584 0.82371 0.86158 1.02245
64  0.623738 0.78561 0.82371 0.86181 1.02368
65  0.622415 0.78535 0.82371 0.86206 1.02500
66  0.621004 0.78508 0.82371 0.86233 1.02641
67  0.603347 0.76864 0.80755 0.84646 1.01176
68  0.517773 0.68436 0.72358 0.76279 0.92939
69  0.447017 0.61499 0.65453 0.69407 0.86203
70  0.424919 0.59434 0.63423 0.67411 0.84354
71  0.415151 0.58611 0.62635 0.66659 0.83754
72  0.412752 0.58531 0.62593 0.66655 0.83910
73  0.410672 0.58491 0.62593 0.66694 0.84118
74  0.408500 0.58450 0.62593 0.66736 0.84336
75  0.406237 0.58407 0.62593 0.66779 0.84562
76  0.403877 0.58362 0.62593 0.66824 0.84798
77  0.401416 0.58315 0.62593 0.66871 0.85044
78  0.398857 0.58266 0.62593 0.66920 0.85300
79  0.396204 0.58216 0.62593 0.66970 0.85565
80  0.393459 0.58163 0.62593 0.67022 0.85840
81  0.390617 0.58109 0.62593 0.67077 0.86124
82  0.374443 0.56730 0.61269 0.65809 0.85094
83  0.318567 0.51387 0.55985 0.60582 0.80113
84  0.254683 0.45252 0.49909 0.54566 0.74350
85  0.239922 0.44037 0.48756 0.53474 0.73519
86  0.236598 0.43974 0.48756 0.53537 0.73851
87  0.233177 0.43909 0.48756 0.53603 0.74193
88  0.229664 0.43842 0.48756 0.53670 0.74545
89  0.226054 0.43773 0.48756 0.53738 0.74906
90  0.222347 0.43702 0.48756 0.53809 0.75277
91  0.218545 0.43630 0.48756 0.53881 0.75657
92  0.211609 0.43252 0.48452 0.53652 0.75743
93  0.175334 0.39947 0.45224 0.50500 0.72914
94  0.134202 0.36165 0.41520 0.46874 0.69619
95  0.124583 0.35542 0.40976 0.46410 0.69494
96  0.120301 0.35461 0.40976 0.46492 0.69923
97  0.115924 0.35377 0.40976 0.46575 0.70360
98  0.111451 0.35292 0.40976 0.46661 0.70808
99  0.100429 0.34560 0.40331 0.46102 0.70619
100 0.075875 0.32482 0.38342 0.44202 0.69096
knots :
 [1] -1.00 -0.97 -0.94 -0.90 -0.87 -0.84 -0.80 -0.77 -0.73 -0.70 -0.67 -0.63
[13] -0.60 -0.56 -0.53 -0.50 -0.46 -0.43 -0.39 -0.36 -0.33 -0.29 -0.26 -0.23
[25] -0.19 -0.16 -0.12 -0.09 -0.06 -0.02  0.01  0.05  0.08  0.11  0.15  0.18
[37]  0.22  0.25  0.28  0.32  0.35  0.38  0.42  0.45  0.49  0.52  0.55  0.59
[49]  0.62  0.66  0.69  0.72  0.76  0.79  0.83  0.86  0.89  0.93  0.96  1.00
coef  :
 [1]   2.70908   2.70908   2.70908   2.70908   2.60218   2.25402   2.25402
 [8]   2.25402   2.25402   2.06188   2.06188   1.90251   1.65189   1.65189
[15]   1.65189   1.65189   1.65189   1.65189   1.58952   1.58952   1.31745
[22]   1.31745   1.31745   1.12319   1.12319   1.12319   1.12319   1.12319
[29]   1.12319   1.12319   0.83972   0.83972   0.83972   0.83972   0.83972
[36]   0.82371   0.82371   0.82371   0.82371   0.82371   0.82371   0.66014
[43]   0.62593   0.62593   0.62593   0.62593   0.62593   0.62593   0.62593
[50]   0.62593   0.48756   0.48756   0.48756   0.48756   0.48756   0.48756
[57]   0.40976   0.40976   0.40976   0.40976   0.38342 386.84235
> 1 - sum(cXy3 $ resid ^ 2) / sum((y - mean(y))^2) # R^2 = 80.424%
[1] 0.81133
> 
> cpuTime(cXy4 <- cobs(X,y, "decrease", lambda= 1e-6, nknots = 100))#~16.5"
Time elapsed: 0.062 
> ## not converged (in 4020 iter.)
> 1 - sum(cXy4 $ resid ^ 2) / sum((y - mean(y))^2) # R^2 = 80.517%
[1] 0.81529
> 
> cpuTime(cXy5 <- cobs(X,y, "decrease", lambda= 1e-6, nknots = 150))#~12.8"
Time elapsed: 0.072 
> 1 - sum(cXy5 $ resid ^ 2) / sum((y - mean(y))^2) # R^2 = 81.329%
[1] 0.81881
> 
> 
> 
> 
> 
> 
> 
> 
